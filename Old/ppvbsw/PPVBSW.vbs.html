<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>PetiK's Protect VBS Worm </title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
}
.sc7 {
}
</style>
</head>
<body>

<img src="ppvbsw.png">
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">'PetiK's Protect VBS Worm
'On Error Resume Next
</span><span class="sc7">ppvwtitle</span><span class="sc6">=</span><span class="sc4">"PetiK's Protect VBS Worm"</span><span class="sc0">
</span><span class="sc7">MsgBox</span><span class="sc0"> </span><span class="sc4">"PPVBSW 1.0 coded by PetiK - 2002"</span><span class="sc6">,</span><span class="sc7">vbinformation</span><span class="sc6">,</span><span class="sc7">ppvwtitle</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">fso</span><span class="sc6">=</span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"Scripting.FileSystemObject"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">ws</span><span class="sc6">=</span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"WScript.Shell"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">vbsfile</span><span class="sc6">=</span><span class="sc7">InputBox</span><span class="sc6">(</span><span class="sc4">"Enter the full name of the VBS file:"</span><span class="sc6">&amp;</span><span class="sc7">VbCrLf&amp;VbCrLf&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"To install type ""INSTALL"""</span><span class="sc6">&amp;</span><span class="sc7">VbCrLf&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"To uninstall type ""UNINSTALL"""</span><span class="sc6">,</span><span class="sc4">"PetiK's Protect VBS Worm"</span><span class="sc6">,</span><span class="sc7">fso.GetSpecialFolder</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">))</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">vbsfile</span><span class="sc6">)=</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">WScript.Quit</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">vbsfile</span><span class="sc6">=</span><span class="sc4">"INSTALL"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">fso.CreateFolder</span><span class="sc6">(</span><span class="sc4">"C:\PPVBSW"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">fso.GetFile</span><span class="sc6">(</span><span class="sc7">WScript.ScriptFullName</span><span class="sc6">).</span><span class="sc7">Copy</span><span class="sc6">(</span><span class="sc4">"C:\PPVBSW\ProtectVBSWorm.vbs"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">rm</span><span class="sc6">=</span><span class="sc7">fso.CreateTextFile</span><span class="sc6">(</span><span class="sc4">"C:\PPVBSW\ReadMe.txt"</span><span class="sc6">,</span><span class="sc3">True</span><span class="sc6">,</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">rm.WriteLine</span><span class="sc0"> </span><span class="sc4">"Name : PetiK's Protect VBS Worm (PPVBSW)"</span><span class="sc0">
</span><span class="sc7">rm.WriteLine</span><span class="sc0"> </span><span class="sc4">"Version : 1.0"</span><span class="sc0">
</span><span class="sc7">rm.WriteLine</span><span class="sc0"> </span><span class="sc4">"Author : PetiK"</span><span class="sc0">
</span><span class="sc7">rm.WriteLine</span><span class="sc0"> </span><span class="sc4">"Language : VBS"</span><span class="sc0">
</span><span class="sc7">rm.WriteLine</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">rm.WriteLine</span><span class="sc0"> </span><span class="sc4">"Comments : To control some suspicious VBS files."</span><span class="sc0">
</span><span class="sc7">rm.Close</span><span class="sc0">
</span><span class="sc7">MsgBox</span><span class="sc0"> </span><span class="sc4">"PPVBSW installed on system"</span><span class="sc6">,</span><span class="sc7">vbinformation</span><span class="sc6">,</span><span class="sc7">ppvwtitle</span><span class="sc0">
</span><span class="sc7">WScript.Quit</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">vbsfile</span><span class="sc6">=</span><span class="sc4">"UNINSTALL"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">fso.DeleteFile</span><span class="sc6">(</span><span class="sc4">"C:\PPVBSW\ReadMe.txt"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">fso.Deletefile</span><span class="sc6">(</span><span class="sc4">"C:\PPVBSW\ProtectVBSWorm.vbs"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">fso.DeleteFolder</span><span class="sc6">(</span><span class="sc4">"C:\PPVBSW"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">MsgBox</span><span class="sc0"> </span><span class="sc4">"PPVBSW uninstalled from system"</span><span class="sc6">,</span><span class="sc7">vbinformation</span><span class="sc6">,</span><span class="sc7">ppvwtitle</span><span class="sc0">
</span><span class="sc7">ws.Run</span><span class="sc0"> </span><span class="sc7">fso.GetSpecialFolder</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)&amp;</span><span class="sc4">"\notepad.exe"</span><span class="sc0">
</span><span class="sc7">WScript.Quit</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc1">'Check if the file exists
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">not</span><span class="sc0"> </span><span class="sc7">fso.FileExists</span><span class="sc6">(</span><span class="sc7">vbsfile</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">MsgBox</span><span class="sc0"> </span><span class="sc4">"This file doesn't exist !"</span><span class="sc6">,</span><span class="sc7">vbcritical</span><span class="sc6">,</span><span class="sc7">ppvwtitle</span><span class="sc0">
</span><span class="sc7">WScript.Quit</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc1">'Check if it is a VBS file (.vbs)
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">right</span><span class="sc6">(</span><span class="sc7">vbsfile</span><span class="sc6">,</span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">".vbs"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">MsgBox</span><span class="sc0"> </span><span class="sc4">"This file is not a VBS file (.vbs) !"</span><span class="sc6">,</span><span class="sc7">vbcritical</span><span class="sc6">,</span><span class="sc7">ppvwtitle</span><span class="sc0">
</span><span class="sc7">WScript.Quit</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">fl</span><span class="sc6">=</span><span class="sc7">fso.OpenTextFile</span><span class="sc6">(</span><span class="sc7">vbsfile</span><span class="sc6">,</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">readvbs</span><span class="sc6">=</span><span class="sc7">fl.ReadAll</span><span class="sc0">
</span><span class="sc7">fl.Close</span><span class="sc0">

</span><span class="sc7">numr</span><span class="sc6">=</span><span class="sc4">""</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc7">randomize</span><span class="sc6">(</span><span class="sc7">timer</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">numr</span><span class="sc6">=</span><span class="sc7">numr</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc7">int</span><span class="sc6">(</span><span class="sc7">rnd</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)*</span><span class="sc2">9</span><span class="sc6">)+</span><span class="sc2">48</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">news</span><span class="sc6">=</span><span class="sc7">fso.CreateTextFile</span><span class="sc6">(</span><span class="sc4">"ppvbsw_"</span><span class="sc6">&amp;</span><span class="sc7">numr&amp;</span><span class="sc4">".txt"</span><span class="sc6">,</span><span class="sc3">True</span><span class="sc6">,</span><span class="sc2">8</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">"Name of file : "</span><span class="sc6">&amp;</span><span class="sc7">vbsfile</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">"Size of file : "</span><span class="sc6">&amp;</span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">readvbs</span><span class="sc6">)&amp;</span><span class="sc4">" bytes"</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">"Date and Time of analysis : "</span><span class="sc6">&amp;</span><span class="sc3">date&amp;</span><span class="sc4">" "</span><span class="sc6">&amp;</span><span class="sc7">time</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">

</span><span class="sc1">'Check for Regedit
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">readvbs</span><span class="sc6">,</span><span class="sc4">"CurrentVersion\Run"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">"Run with regedit (Run) : Yes"</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">"Run with regedit (Run) : No"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">readvbs</span><span class="sc6">,</span><span class="sc4">"CurrentVersion\RunServices"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">"Run with regedit (RunServices) : Yes"</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">"Run with regedit (RunServices) : No"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">

</span><span class="sc1">'Check if infect other file
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">readvbs</span><span class="sc6">,</span><span class="sc4">"GetExtensionName"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">"Perhaps infects some files : Yes"</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">"Perhaps infects some files : No"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">

</span><span class="sc1">'Check for Outlook
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">readvbs</span><span class="sc6">,</span><span class="sc4">"Outlook.Application"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">MsgBox</span><span class="sc0"> </span><span class="sc4">"This suspect file uses Outlook to spread"</span><span class="sc6">,</span><span class="sc7">vbcritical</span><span class="sc6">,</span><span class="sc7">ppvwtitle</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">"Spread with Outlook : Yes"</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">"Spread with Outlook : No"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc1">'Check for Word
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">readvbs</span><span class="sc6">,</span><span class="sc4">"Word.Application"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">MsgBox</span><span class="sc0"> </span><span class="sc4">"This suspect file uses Word to infect some files or spread"</span><span class="sc6">,</span><span class="sc7">vbcritical</span><span class="sc6">,</span><span class="sc7">ppvwtitle</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">"Spread or Infect with Word : Yes"</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">"Spread or Infect with Word : No"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">

</span><span class="sc1">'Check for some known VBS worm
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc4">"Possible VBS Worm :"</span><span class="sc0">
</span><span class="sc7">kworm</span><span class="sc0"> </span><span class="sc4">"Cool Notepad Demo"</span><span class="sc6">,</span><span class="sc4">"I-Worm.CoolNotepad"</span><span class="sc0">
</span><span class="sc7">kworm</span><span class="sc0"> </span><span class="sc4">"I'm proud to say that you are infected by FireburN"</span><span class="sc6">,</span><span class="sc4">"I-Worm.FireBurn"</span><span class="sc0">
</span><span class="sc7">kworm</span><span class="sc0"> </span><span class="sc4">"FRIEND_MESSAGE.TXT.vbs"</span><span class="sc6">,</span><span class="sc4">"I-Worm.FriendMess"</span><span class="sc0">
</span><span class="sc7">kworm</span><span class="sc0"> </span><span class="sc4">"Lee"</span><span class="sc6">,</span><span class="sc4">"I-Worm.Lee family"</span><span class="sc0">
</span><span class="sc7">kworm</span><span class="sc0"> </span><span class="sc4">"ILOVEYOU"</span><span class="sc6">,</span><span class="sc4">"I-Worm.Loveletter.A"</span><span class="sc0">
</span><span class="sc7">kworm</span><span class="sc0"> </span><span class="sc4">"mothersday.vbs"</span><span class="sc6">,</span><span class="sc4">"I-Worm.Loveletter.B"</span><span class="sc0">
</span><span class="sc7">kworm</span><span class="sc0"> </span><span class="sc4">"Very Funny.vbs"</span><span class="sc6">,</span><span class="sc4">"I-Worm.Loveletter.C"</span><span class="sc0">
</span><span class="sc7">kworm</span><span class="sc0"> </span><span class="sc4">"Susitikim shi vakara kavos puodukui..."</span><span class="sc6">,</span><span class="sc4">"I-Worm.Loveletter.D"</span><span class="sc0">
</span><span class="sc7">kworm</span><span class="sc0"> </span><span class="sc4">"Bill Gates is guitly of monopoly. Here is the proof"</span><span class="sc6">,</span><span class="sc4">"I-Worm.Monopoly"</span><span class="sc0">
</span><span class="sc7">kworm</span><span class="sc0"> </span><span class="sc4">"DocXlsMdbBmpMp3TxtJpgGifMovUrlHtmTxt"</span><span class="sc6">,</span><span class="sc4">"I-Worm.NewLove"</span><span class="sc0">
</span><span class="sc7">kworm</span><span class="sc0"> </span><span class="sc4">"US PRESIDENT AND FBI SECRETS =PLEASE VISIT"</span><span class="sc6">,</span><span class="sc4">"I-Worm.Plan"</span><span class="sc0">
</span><span class="sc7">kworm</span><span class="sc0"> </span><span class="sc4">"LIFE_STAGES.TXT.SHS"</span><span class="sc6">,</span><span class="sc4">"I-Worm.ScrapWorm"</span><span class="sc0">
</span><span class="sc7">kworm</span><span class="sc0"> </span><span class="sc4">"TIMOFONICA.TXT.vbs"</span><span class="sc6">,</span><span class="sc4">"I-Worm.Timofonica"</span><span class="sc0">

</span><span class="sc7">news.Close</span><span class="sc0">

</span><span class="sc7">ws.Run</span><span class="sc0"> </span><span class="sc4">"ppvbsw_"</span><span class="sc6">&amp;</span><span class="sc7">numr&amp;</span><span class="sc4">".txt"</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">kworm</span><span class="sc6">(</span><span class="sc7">strg</span><span class="sc6">,</span><span class="sc7">name</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">readvbs</span><span class="sc6">,</span><span class="sc7">strg</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">news.WriteLine</span><span class="sc0"> </span><span class="sc7">name</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc7">Sub</span></div></body>
</html>
