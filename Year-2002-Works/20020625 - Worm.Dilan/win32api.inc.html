<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>win32api.inc.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;                       . .: .:.. :.. .. .:.::. :. ..:</span><span class="sc0">
</span><span class="sc1">;                     &lt;&lt;-==ЬЫЫЫЫЫЬ=ЬЫЫЫЫЫЬ=ЬЫЫЫЫЫЬ===&lt;</span><span class="sc0">
</span><span class="sc1">;                      .:: ЫЫЫ ЫЫЫ:ЫЫЫ ЫЫЫ.ЫЫЫ ЫЫЫ .:.</span><span class="sc0">
</span><span class="sc1">;                      . .:.ЬЬЬЫЫЯ.ЯЫЫЫЫЫЫ.ЫЫЫЫЫЫЫ:..</span><span class="sc0">
</span><span class="sc1">;                       ...ЫЫЫЬЬЬЬ:ЬЬЬЬЫЫЫ:ЫЫЫ ЫЫЫ.::.</span><span class="sc0">
</span><span class="sc1">;                      &gt;===ЫЫЫЫЫЫЫ=ЫЫЫЫЫЫЯ=ЫЫЫ ЫЫЫ=-&gt;&gt;</span><span class="sc0">
</span><span class="sc1">;                     .: .:.. ..:. .: ..:.::. ::.. :.:.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;                              [29A INC files]</span><span class="sc0">
</span><span class="sc1">;                           Win32 API definitionz</span><span class="sc0">
</span><span class="sc1">;                            by Jacky Qwerty/29A</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Description</span><span class="sc0">
</span><span class="sc1">; ДДДДДДДДДДД</span><span class="sc0">
</span><span class="sc1">; This include file contains some  of the constantz and structurez needed to</span><span class="sc0">
</span><span class="sc1">; work with typical Win32 API functionz from inside ASM filez. This file can</span><span class="sc0">
</span><span class="sc1">; work only with TASM(32), of course. MASM sucks.. :P</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Disclaimer</span><span class="sc0">
</span><span class="sc1">; ДДДДДДДДДД</span><span class="sc0">
</span><span class="sc1">; This file was built up by Jacky Qwerty from 29A. The author is not respon-</span><span class="sc0">
</span><span class="sc1">; sible for any problemz caused due to use/misuse of this file.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; (c) 1997. No rightz reserved. Use without permision &gt;8P.</span><span class="sc0">


</span><span class="sc1">; ДДґ Some global constantz ГДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД</span><span class="sc0">

</span><span class="sc5">NULL</span><span class="sc0">                            </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FALSE</span><span class="sc0">                           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">TRUE</span><span class="sc0">                            </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">MAX_PATH</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">260</span><span class="sc0">
</span><span class="sc5">INVALID_HANDLE_VALUE</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">STANDARD_RIGHTS_REQUIRED</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000F0000h</span><span class="sc0">

</span><span class="sc1">; ДДґ Desired access valuez ГДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД</span><span class="sc0">

</span><span class="sc5">GENERIC_READ</span><span class="sc0">                    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">80000000h</span><span class="sc0">
</span><span class="sc5">GENERIC_WRITE</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">40000000h</span><span class="sc0">

</span><span class="sc1">; ДДґ Share mode valuez ГДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД</span><span class="sc0">

</span><span class="sc5">FILE_SHARE_READ</span><span class="sc0">                 </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000001h</span><span class="sc0">
</span><span class="sc5">FILE_SHARE_WRITE</span><span class="sc0">                </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000002h</span><span class="sc0">

</span><span class="sc1">; ДДґ Creation disposition valuez ГДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД</span><span class="sc0">

</span><span class="sc5">CREATE_NEW</span><span class="sc0">                      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">CREATE_ALWAYS</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">OPEN_EXISTING</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">OPEN_ALWAYS</span><span class="sc0">                     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">TRUNCATE_EXISTING</span><span class="sc0">               </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">5</span><span class="sc0">

</span><span class="sc1">; ДДґ File attributez and flag valuez ГДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД</span><span class="sc0">

</span><span class="sc5">FILE_ATTRIBUTE_READONLY</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000001h</span><span class="sc0">
</span><span class="sc5">FILE_ATTRIBUTE_HIDDEN</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000002h</span><span class="sc0">
</span><span class="sc5">FILE_ATTRIBUTE_SYSTEM</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000004h</span><span class="sc0">
</span><span class="sc5">FILE_ATTRIBUTE_DIRECTORY</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000010h</span><span class="sc0">
</span><span class="sc5">FILE_ATTRIBUTE_ARCHIVE</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000020h</span><span class="sc0">
</span><span class="sc5">FILE_ATTRIBUTE_NORMAL</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000080h</span><span class="sc0">
</span><span class="sc5">FILE_ATTRIBUTE_TEMPORARY</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000100h</span><span class="sc0">
</span><span class="sc5">FILE_ATTRIBUTE_ATOMIC_WRITE</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000200h</span><span class="sc0">
</span><span class="sc5">FILE_ATTRIBUTE_XACTION_WRITE</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000400h</span><span class="sc0">
</span><span class="sc5">FILE_ATTRIBUTE_COMPRESSED</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000800h</span><span class="sc0">
</span><span class="sc5">FILE_ATTRIBUTE_HAS_EMBEDDING</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00001000h</span><span class="sc0">

</span><span class="sc5">FILE_FLAG_POSIX_SEMANTICS</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">01000000h</span><span class="sc0">
</span><span class="sc5">FILE_FLAG_BACKUP_SEMANTICS</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">02000000h</span><span class="sc0">
</span><span class="sc5">FILE_FLAG_DELETE_ON_CLOSE</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">04000000h</span><span class="sc0">
</span><span class="sc5">FILE_FLAG_SEQUENTIAL_SCAN</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">08000000h</span><span class="sc0">
</span><span class="sc5">FILE_FLAG_RANDOM_ACCESS</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">10000000h</span><span class="sc0">
</span><span class="sc5">FILE_FLAG_NO_BUFFERING</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">20000000h</span><span class="sc0">
</span><span class="sc5">FILE_FLAG_OVERLAPPED</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">40000000h</span><span class="sc0">
</span><span class="sc5">FILE_FLAG_WRITE_THROUGH</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">80000000h</span><span class="sc0">

</span><span class="sc1">; ДДґ Protection and other valuez ГДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД</span><span class="sc0">

</span><span class="sc5">SECTION_QUERY</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000001h</span><span class="sc0">
</span><span class="sc5">SECTION_MAP_WRITE</span><span class="sc0">               </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000002h</span><span class="sc0">
</span><span class="sc5">SECTION_MAP_READ</span><span class="sc0">                </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000004h</span><span class="sc0">
</span><span class="sc5">SECTION_MAP_EXECUTE</span><span class="sc0">             </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000008h</span><span class="sc0">
</span><span class="sc5">SECTION_EXTEND_SIZE</span><span class="sc0">             </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000010h</span><span class="sc0">

</span><span class="sc5">SECTION_ALL_ACCESS</span><span class="sc0">              </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">STANDARD_RIGHTS_REQUIRED</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> \
                                        </span><span class="sc5">SECTION_QUERY</span><span class="sc0">            </span><span class="sc6">OR</span><span class="sc0"> \
                                        </span><span class="sc5">SECTION_MAP_WRITE</span><span class="sc0">        </span><span class="sc6">OR</span><span class="sc0"> \
                                        </span><span class="sc5">SECTION_MAP_READ</span><span class="sc0">         </span><span class="sc6">OR</span><span class="sc0"> \
                                        </span><span class="sc5">SECTION_MAP_EXECUTE</span><span class="sc0">      </span><span class="sc6">OR</span><span class="sc0"> \
                                        </span><span class="sc5">SECTION_EXTEND_SIZE</span><span class="sc0">

</span><span class="sc5">FILE_MAP_COPY</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">SECTION_QUERY</span><span class="sc0">
</span><span class="sc5">FILE_MAP_WRITE</span><span class="sc0">                  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">SECTION_MAP_WRITE</span><span class="sc0">
</span><span class="sc5">FILE_MAP_READ</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">SECTION_MAP_READ</span><span class="sc0">
</span><span class="sc5">FILE_MAP_ALL_ACCESS</span><span class="sc0">             </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">SECTION_ALL_ACCESS</span><span class="sc0">

</span><span class="sc5">PAGE_NOACCESS</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000001h</span><span class="sc0">
</span><span class="sc5">PAGE_READONLY</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000002h</span><span class="sc0">
</span><span class="sc5">PAGE_READWRITE</span><span class="sc0">                  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000004h</span><span class="sc0">
</span><span class="sc5">PAGE_WRITECOPY</span><span class="sc0">                  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000008h</span><span class="sc0">
</span><span class="sc5">PAGE_EXECUTE</span><span class="sc0">                    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000010h</span><span class="sc0">
</span><span class="sc5">PAGE_EXECUTE_READ</span><span class="sc0">               </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000020h</span><span class="sc0">
</span><span class="sc5">PAGE_EXECUTE_READWRITE</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000040h</span><span class="sc0">
</span><span class="sc5">PAGE_EXECUTE_WRITECOPY</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000080h</span><span class="sc0">
</span><span class="sc5">PAGE_GUARD</span><span class="sc0">                      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000100h</span><span class="sc0">
</span><span class="sc5">PAGE_NOCACHE</span><span class="sc0">                    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000200h</span><span class="sc0">
</span><span class="sc5">MEM_COMMIT</span><span class="sc0">                      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00001000h</span><span class="sc0">
</span><span class="sc5">MEM_RESERVE</span><span class="sc0">                     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00002000h</span><span class="sc0">
</span><span class="sc5">MEM_DECOMMIT</span><span class="sc0">                    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00004000h</span><span class="sc0">
</span><span class="sc5">MEM_RELEASE</span><span class="sc0">                     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00008000h</span><span class="sc0">
</span><span class="sc5">MEM_FREE</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00010000h</span><span class="sc0">
</span><span class="sc5">MEM_PRIVATE</span><span class="sc0">                     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00020000h</span><span class="sc0">
</span><span class="sc5">MEM_MAPPED</span><span class="sc0">                      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00040000h</span><span class="sc0">
</span><span class="sc5">MEM_TOP_DOWN</span><span class="sc0">                    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00100000h</span><span class="sc0">
</span><span class="sc5">SEC_FILE</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00800000h</span><span class="sc0">
</span><span class="sc5">SEC_IMAGE</span><span class="sc0">                       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">01000000h</span><span class="sc0">
</span><span class="sc5">SEC_RESERVE</span><span class="sc0">                     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">04000000h</span><span class="sc0">
</span><span class="sc5">SEC_COMMIT</span><span class="sc0">                      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">08000000h</span><span class="sc0">
</span><span class="sc5">SEC_NOCACHE</span><span class="sc0">                     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">10000000h</span><span class="sc0">
</span><span class="sc5">MEM_IMAGE</span><span class="sc0">                       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">SEC_IMAGE</span><span class="sc0">

</span><span class="sc1">; ДДґ Code Page valuez ГДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД</span><span class="sc0">

</span><span class="sc5">CP_ACP</span><span class="sc0">                          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc0">       </span><span class="sc1">; ANSI code page</span><span class="sc0">
</span><span class="sc5">CP_OEMCP</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">1</span><span class="sc0">       </span><span class="sc1">; OEM  code page</span><span class="sc0">
</span><span class="sc5">CP_MACCP</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">2</span><span class="sc0">       </span><span class="sc1">; MAC  code page</span><span class="sc0">

</span><span class="sc1">; ДДґ Message Box suport valuez ГДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД</span><span class="sc0">

</span><span class="sc5">MB_OK</span><span class="sc0">                           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000000h</span><span class="sc0">
</span><span class="sc5">MB_OKCANCEL</span><span class="sc0">                     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000001h</span><span class="sc0">
</span><span class="sc5">MB_ABORTRETRYIGNORE</span><span class="sc0">             </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000002h</span><span class="sc0">
</span><span class="sc5">MB_YESNOCANCEL</span><span class="sc0">                  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000003h</span><span class="sc0">
</span><span class="sc5">MB_YESNO</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000004h</span><span class="sc0">
</span><span class="sc5">MB_RETRYCANCEL</span><span class="sc0">                  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000005h</span><span class="sc0">
</span><span class="sc5">MB_TYPEMASK</span><span class="sc0">                     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0000000Fh</span><span class="sc0">

</span><span class="sc5">MB_ICONHAND</span><span class="sc0">                     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000010h</span><span class="sc0">
</span><span class="sc5">MB_ICONQUESTION</span><span class="sc0">                 </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000020h</span><span class="sc0">
</span><span class="sc5">MB_ICONEXCLAMATION</span><span class="sc0">              </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000030h</span><span class="sc0">
</span><span class="sc5">MB_ICONASTERISK</span><span class="sc0">                 </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000040h</span><span class="sc0">
</span><span class="sc5">MB_ICONMASK</span><span class="sc0">                     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000000F0h</span><span class="sc0">

</span><span class="sc5">MB_ICONINFORMATION</span><span class="sc0">              </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">MB_ICONASTERISK</span><span class="sc0">
</span><span class="sc5">MB_ICONSTOP</span><span class="sc0">                     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">MB_ICONHAND</span><span class="sc0">

</span><span class="sc5">MB_DEFBUTTON1</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000000h</span><span class="sc0">
</span><span class="sc5">MB_DEFBUTTON2</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000100h</span><span class="sc0">
</span><span class="sc5">MB_DEFBUTTON3</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000200h</span><span class="sc0">
</span><span class="sc5">MB_DEFMASK</span><span class="sc0">                      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000F00h</span><span class="sc0">

</span><span class="sc5">MB_APPLMODAL</span><span class="sc0">                    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00000000h</span><span class="sc0">
</span><span class="sc5">MB_SYSTEMMODAL</span><span class="sc0">                  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00001000h</span><span class="sc0">
</span><span class="sc5">MB_TASKMODAL</span><span class="sc0">                    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00002000h</span><span class="sc0">

</span><span class="sc5">MB_NOFOCUS</span><span class="sc0">                      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00008000h</span><span class="sc0">

</span><span class="sc1">; ДДґ Some general Win32 related structurez ГДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД</span><span class="sc0">

</span><span class="sc5">FILETIME</span><span class="sc0">                        </span><span class="sc9">STRUC</span><span class="sc0">
        </span><span class="sc5">FT_dwLowDateTime</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">FT_dwHighDateTime</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FILETIME</span><span class="sc0">                        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">WIN32_FIND_DATA</span><span class="sc0">                 </span><span class="sc9">STRUC</span><span class="sc0">
        </span><span class="sc5">WFD_dwFileAttributes</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">WFD_ftCreationTime</span><span class="sc0">      </span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">WFD_ftLastAccessTime</span><span class="sc0">    </span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">WFD_ftLastWriteTime</span><span class="sc0">     </span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">WFD_nFileSizeHigh</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">WFD_nFileSizeLow</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">WFD_dwReserved0</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">WFD_dwReserved1</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">WFD_szFileName</span><span class="sc0">          </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc5">MAX_PATH</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc5">WFD_szAlternateFileName</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
                                </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">    </span><span class="sc1">; dword padding</span><span class="sc0">
</span><span class="sc5">WIN32_FIND_DATA</span><span class="sc0">                 </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">SIZEOF_WIN32_FIND_DATA</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">SIZE</span><span class="sc0"> </span><span class="sc5">WIN32_FIND_DATA</span><span class="sc0">

</span><span class="sc1">; ДДґ Context related stuff (i386, i486) ГДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД</span><span class="sc0">

</span><span class="sc1">; The following flagz control the contentz of the CONTEXT structure:</span><span class="sc0">

</span><span class="sc5">CONTEXT_i386</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00010000h</span><span class="sc0">       </span><span class="sc1">; This assumes that i386 and i486</span><span class="sc0">
</span><span class="sc5">CONTEXT_i486</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">00010000h</span><span class="sc0">       </span><span class="sc1">;   have identical context recordz.</span><span class="sc0">

</span><span class="sc5">CONTEXT_CONTROL</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">CONTEXT_i386</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc2">01h</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; SS:SP, CS:IP, FLAGS, BP.</span><span class="sc0">
</span><span class="sc5">CONTEXT_INTEGER</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">CONTEXT_i386</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; AX, BX, CX, DX, SI, DI.</span><span class="sc0">
</span><span class="sc5">CONTEXT_SEGMENTS</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">CONTEXT_i386</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc2">04h</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; DS, ES, FS, GS.</span><span class="sc0">
</span><span class="sc5">CONTEXT_FLOATING_POINT</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">CONTEXT_i386</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc2">08h</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; 387 state</span><span class="sc0">
</span><span class="sc5">CONTEXT_DEBUG_REGISTERS</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">CONTEXT_i386</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; DB 0-3,6,7</span><span class="sc0">

</span><span class="sc5">CONTEXT_FULL</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">CONTEXT_CONTROL</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">CONTEXT_INTEGER</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> \
                             </span><span class="sc5">CONTEXT_SEGMENTS</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc1">; Size of the 80387 save area, which is in the context frame:</span><span class="sc0">

</span><span class="sc5">SIZE_OF_80387_REGISTERS</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">80</span><span class="sc0">

</span><span class="sc5">FLOATING_SAVE_AREA</span><span class="sc0">              </span><span class="sc9">STRUC</span><span class="sc0">
        </span><span class="sc5">ControlWord</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">StatusWord</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">TagWord</span><span class="sc0">                 </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">ErrorOffset</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">ErrorSelector</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">DataOffset</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">DataSelector</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">RegisterArea</span><span class="sc0">            </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc5">SIZE_OF_80387_REGISTERS</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc5">Cr0NpxState</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FLOATING_SAVE_AREA</span><span class="sc0">              </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc1">; Context Frame:</span><span class="sc0">

</span><span class="sc5">CONTEXT</span><span class="sc0">                         </span><span class="sc9">STRUC</span><span class="sc0">

</span><span class="sc1">; The flags valuez - within the ContextFlags field - control the</span><span class="sc0">
</span><span class="sc1">; contentz of the CONTEXT structure.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; If the context record is used as an input parameter, then</span><span class="sc0">
</span><span class="sc1">; for each portion of the context record controlled by a flag</span><span class="sc0">
</span><span class="sc1">; whose value is set, it is asumed that that portion of the</span><span class="sc0">
</span><span class="sc1">; context record contains valid context. If the context record</span><span class="sc0">
</span><span class="sc1">; is being used to modify a threadz context, then only that</span><span class="sc0">
</span><span class="sc1">; portion of the threadz context will be modified.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; If the context record is used as an IN OUT parameter to capture</span><span class="sc0">
</span><span class="sc1">; the context of a thread, then only those portionz of the thread's</span><span class="sc0">
</span><span class="sc1">; context corresponding to set flags will be returned.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; The context record is never used as an OUT only parameter.</span><span class="sc0">

        </span><span class="sc5">CONTEXT_ContextFlags</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc1">; This section is specified/returned if CONTEXT_DEBUG_REGISTERS is</span><span class="sc0">
</span><span class="sc1">; set in ContextFlags. Note that CONTEXT_DEBUG_REGISTERS is NOT</span><span class="sc0">
</span><span class="sc1">; included in CONTEXT_FULL:</span><span class="sc0">

        </span><span class="sc5">CONTEXT_Dr0</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_Dr1</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_Dr2</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_Dr3</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_Dr6</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_Dr7</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc1">; This section is specified/returned if the</span><span class="sc0">
</span><span class="sc1">; ContextFlags word contains the flag CONTEXT_FLOATING_POINT:</span><span class="sc0">

        </span><span class="sc5">CONTEXT_FloatSave</span><span class="sc0">       </span><span class="sc5">FLOATING_SAVE_AREA</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc1">; This section is specified/returned if the</span><span class="sc0">
</span><span class="sc1">; ContextFlags word contains the flag CONTEXT_SEGMENTS:</span><span class="sc0">

        </span><span class="sc5">CONTEXT_SegGs</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_SegFs</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_SegEs</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_SegDs</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc1">; This section is specified/returned if the</span><span class="sc0">
</span><span class="sc1">; ContextFlags word contains the flag CONTEXT_INTEGER:</span><span class="sc0">

        </span><span class="sc5">CONTEXT_Edi</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_Esi</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_Ebx</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_Edx</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_Ecx</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_Eax</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc1">; This section is specified/returned if the</span><span class="sc0">
</span><span class="sc1">; ContextFlags word contains the flag CONTEXT_CONTROL:</span><span class="sc0">

        </span><span class="sc5">CONTEXT_Ebp</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_Eip</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_SegCs</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">; MUST BE SANITIZED</span><span class="sc0">
        </span><span class="sc5">CONTEXT_EFlags</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">; MUST BE SANITIZED</span><span class="sc0">
        </span><span class="sc5">CONTEXT_Esp</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">CONTEXT_SegSs</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">CONTEXT</span><span class="sc0">                         </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc1">; ДДґ Structured Exception Handling (SEH) related stuff ГДДДДДДДДДДДДДДДДДДДД</span><span class="sc0">

</span><span class="sc1">; This structure is the one pointed to by FS:[0]:</span><span class="sc0">

</span><span class="sc5">EXCEPTIONREGISTRATIONRECORD</span><span class="sc0">     </span><span class="sc9">STRUC</span><span class="sc0">   </span><span class="sc1">; != EXCEPTION_RECORD structure</span><span class="sc0">
        </span><span class="sc5">ERR_prev_structure</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc5">EXCEPTIONREGISTRATIONRECORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">ERR_ExceptionHandler</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; CODE PTR</span><span class="sc0">
        </span><span class="sc1">; These are the minimun fieldz required for proper OS operation</span><span class="sc0">
        </span><span class="sc1">; Other undocumented fieldz exist for Microsoft and Borland compilerz</span><span class="sc0">
</span><span class="sc5">EXCEPTIONREGISTRATIONRECORD</span><span class="sc0">     </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc1">; Exception record definition:</span><span class="sc0">

</span><span class="sc5">EXCEPTION_MAXIMUM_PARAMETERS</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">15</span><span class="sc0">      </span><span class="sc1">; max # of except paramz</span><span class="sc0">

</span><span class="sc5">EXCEPTION_RECORD</span><span class="sc0">                </span><span class="sc9">STRUC</span><span class="sc0">
        </span><span class="sc5">ER_ExceptionCode</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">ER_ExceptionFlags</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">ER_ExceptionRecord</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc5">EXCEPTION_RECORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">ER_ExceptionAddress</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; CODE PTR</span><span class="sc0">
        </span><span class="sc5">ER_NumberParameters</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">ER_ExceptionInformation</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc5">EXCEPTION_MAXIMUM_PARAMETERS</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">EXCEPTION_RECORD</span><span class="sc0">                </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">EXCEPTION_POINTERS</span><span class="sc0">              </span><span class="sc9">STRUC</span><span class="sc0">
        </span><span class="sc5">EP_ExceptionRecord</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc5">EXCEPTION_RECORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">EP_ContextRecord</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc5">CONTEXT</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">EXCEPTION_POINTERS</span><span class="sc0">              </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc1">; Other SEH related constantz and return valuez:</span><span class="sc0">

</span><span class="sc5">EXCEPTION_EXECUTE_HANDLER</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">EXCEPTION_CONTINUE_SEARCH</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">EXCEPTION_CONTINUE_EXECUTION</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">

</span><span class="sc5">EXCEPTION_ACCESS_VIOLATION</span><span class="sc0">              </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C0000005h</span><span class="sc0">
</span><span class="sc5">EXCEPTION_DATATYPE_MISALIGNMENT</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">080000002h</span><span class="sc0">
</span><span class="sc5">EXCEPTION_BREAKPOINT</span><span class="sc0">                    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">080000003h</span><span class="sc0">
</span><span class="sc5">EXCEPTION_SINGLE_STEP</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">080000004h</span><span class="sc0">
</span><span class="sc5">EXCEPTION_ARRAY_BOUNDS_EXCEEDED</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C000008Ch</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLT_DENORMAL_OPERAND</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C000008Dh</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLT_DIVIDE_BY_ZERO</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C000008Eh</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLT_INEXACT_RESULT</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C000008Fh</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLT_INVALID_OPERATION</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C0000090h</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLT_OVERFLOW</span><span class="sc0">                  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C0000091h</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLT_STACK_CHECK</span><span class="sc0">               </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C0000092h</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLT_UNDERFLOW</span><span class="sc0">                 </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C0000093h</span><span class="sc0">
</span><span class="sc5">EXCEPTION_INT_DIVIDE_BY_ZERO</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C0000094h</span><span class="sc0">
</span><span class="sc5">EXCEPTION_INT_OVERFLOW</span><span class="sc0">                  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C0000095h</span><span class="sc0">
</span><span class="sc5">EXCEPTION_PRIV_INSTRUCTION</span><span class="sc0">              </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C0000096h</span><span class="sc0">
</span><span class="sc5">EXCEPTION_IN_PAGE_ERROR</span><span class="sc0">                 </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C0000006h</span><span class="sc0">
</span><span class="sc5">EXCEPTION_ILLEGAL_INSTRUCTION</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C000001Dh</span><span class="sc0">
</span><span class="sc5">EXCEPTION_NONCONTINUABLE_EXCEPTION</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C0000025h</span><span class="sc0">
</span><span class="sc5">EXCEPTION_STACK_OVERFLOW</span><span class="sc0">                </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C00000FDh</span><span class="sc0">
</span><span class="sc5">EXCEPTION_INVALID_DISPOSITION</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0C0000026h</span><span class="sc0">
</span><span class="sc5">EXCEPTION_GUARD_PAGE</span><span class="sc0">                    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">080000001h</span><span class="sc0">

</span><span class="sc1">; Useful structure to access the "Except_Handler" function argumentz:</span><span class="sc0">

</span><span class="sc5">Except_Handler</span><span class="sc0">                  </span><span class="sc9">STRUC</span><span class="sc0">
        </span><span class="sc5">EH_Dummy</span><span class="sc0">                </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                    </span><span class="sc1">; Ret address</span><span class="sc0">
        </span><span class="sc5">EH_ExceptionRecord</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc5">EXCEPTION_RECORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">EH_EstablisherFrame</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">EH_ContextRecord</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc5">CONTEXT</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">EH_DispatcherContext</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Except_Handler</span><span class="sc0">                  </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc1">; The following macroz "@SEH_SetupFrame" and "@SEH_RemoveFrame" are limited</span><span class="sc0">
</span><span class="sc1">; assembler versionz of the _try and _except keywordz used in C language.</span><span class="sc0">
</span><span class="sc1">; They provide fast and powerful "Structured Exception Handling" support</span><span class="sc0">
</span><span class="sc1">; for Win32 applicationz in a few linez of code. Though Microsoft seems</span><span class="sc0">
</span><span class="sc1">; intent on hiding the details of OS-level structured exception handling,</span><span class="sc0">
</span><span class="sc1">; this code relies on documented featurez of the Win32 API implementation</span><span class="sc0">
</span><span class="sc1">; and as such it works in both Windoze 95 and Windoze NT.</span><span class="sc0">

</span><span class="sc5">@SEH_SetupFrame</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0">   </span><span class="sc5">ExceptionHandler</span><span class="sc0">
                </span><span class="sc9">local</span><span class="sc0">   </span><span class="sc5">set_new_eh</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">set_new_eh</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">esp</span><span class="sc4">,[</span><span class="sc5">esp.EH_EstablisherFrame</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc5">ExceptionHandler</span><span class="sc0">
    </span><span class="sc5">set_new_eh</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">         </span><span class="sc1">; Setup new SEH frame</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc8">edx</span><span class="sc4">],</span><span class="sc8">esp</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc1">; The ExceptionHandler argument in the @SEH_SetupFrame macro definition</span><span class="sc0">
</span><span class="sc1">; can be a single instruction or another macro containing several of them.</span><span class="sc0">

</span><span class="sc5">@SEH_RemoveFrame</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0">
                 </span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">         </span><span class="sc1">; Remove new SEH frame and set old</span><span class="sc0">
                 </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
                 </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc9">comment</span><span class="sc0"> #
</span><span class="sc4">//</span><span class="sc0"> </span><span class="sc5">Exception</span><span class="sc0"> </span><span class="sc5">disposition</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">values.</span><span class="sc0">

</span><span class="sc9">typedef</span><span class="sc0"> </span><span class="sc5">enum</span><span class="sc0"> </span><span class="sc5">_EXCEPTION_DISPOSITION</span><span class="sc0"> {
    </span><span class="sc5">ExceptionContinueExecution</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc5">ExceptionContinueSearch</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc5">ExceptionNestedException</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc5">ExceptionCollidedUnwind</span><span class="sc0">
} </span><span class="sc5">EXCEPTION_DISPOSITION</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">EXCEPTION_DISPOSITION</span><span class="sc0"> </span><span class="sc5">__cdecl</span><span class="sc0"> </span><span class="sc5">_except_handler</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc0">
    </span><span class="sc9">struct</span><span class="sc0"> </span><span class="sc5">_EXCEPTION_RECORD</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc5">ExceptionRecord</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc5">void</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc5">EstablisherFrame</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">struct</span><span class="sc0"> </span><span class="sc5">_CONTEXT</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc5">ContextRecord</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc5">void</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc5">DispatcherContext</span><span class="sc0">
    </span><span class="sc4">)</span><span class="sc1">;</span><span class="sc0">
#

</span><span class="sc1">; ДДґ Some Win32 function prototypez ГДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД</span><span class="sc0">

</span><span class="sc9">comment</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0">
</span><span class="sc5">HANDLE</span><span class="sc0">  </span><span class="sc5">CreateFileA</span><span class="sc0">
  </span><span class="sc4">(</span><span class="sc9">ptr</span><span class="sc4">)</span><span class="sc0">  </span><span class="sc5">lpFileName</span><span class="sc0">             </span><span class="sc1">; ptr to name of file</span><span class="sc0">
         </span><span class="sc5">dwDesiredAccess</span><span class="sc0">        </span><span class="sc1">; access (read-write) mode</span><span class="sc0">
         </span><span class="sc5">dwShareMode</span><span class="sc0">            </span><span class="sc1">; share mode</span><span class="sc0">
  </span><span class="sc4">(</span><span class="sc9">ptr</span><span class="sc4">)</span><span class="sc0">  </span><span class="sc5">lpSecurityAttributes</span><span class="sc0">   </span><span class="sc1">; ptr to SECURITY_ATTRIBUTES struc</span><span class="sc0">
         </span><span class="sc5">dwCreationDisposition</span><span class="sc0">  </span><span class="sc1">; how to create</span><span class="sc0">
         </span><span class="sc5">dwFlagsAndAttributes</span><span class="sc0">   </span><span class="sc1">; file and flag attributez</span><span class="sc0">
  </span><span class="sc4">(</span><span class="sc5">hnd</span><span class="sc4">)</span><span class="sc0">  </span><span class="sc5">hTemplateFile</span><span class="sc0">          </span><span class="sc1">; handle to file with attributez to copy</span><span class="sc0">

</span><span class="sc5">Returns</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">opened</span><span class="sc0"> </span><span class="sc5">handle</span><span class="sc0"> </span><span class="sc9">if</span><span class="sc0"> </span><span class="sc5">ok</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">INVALID_HANDLE_VALUE</span><span class="sc0"> </span><span class="sc9">if</span><span class="sc0"> </span><span class="sc5">error.</span><span class="sc0">

</span><span class="sc1">; dwDesiredAccess valuez:</span><span class="sc0">

</span><span class="sc5">GENERIC_READ</span><span class="sc0">
</span><span class="sc5">GENERIC_WRITE</span><span class="sc0">

</span><span class="sc1">; dwShareMode valuez:</span><span class="sc0">

</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">; not shared</span><span class="sc0">
</span><span class="sc5">FILE_SHARE_READ</span><span class="sc0">
</span><span class="sc5">FILE_SHARE_WRITE</span><span class="sc0">

</span><span class="sc1">; dwCreationDisposition valuez:</span><span class="sc0">

</span><span class="sc5">CREATE_NEW</span><span class="sc0">
</span><span class="sc5">CREATE_ALWAYS</span><span class="sc0">
</span><span class="sc5">OPEN_EXISTING</span><span class="sc0">
</span><span class="sc5">OPEN_ALWAYS</span><span class="sc0">
</span><span class="sc5">TRUNCATE_EXISTING</span><span class="sc0">

</span><span class="sc1">; dwFlagsAndAttributes valuez:</span><span class="sc0">

</span><span class="sc5">FILE_ATTRIBUTE_READONLY</span><span class="sc0">
</span><span class="sc5">FILE_ATTRIBUTE_HIDDEN</span><span class="sc0">
</span><span class="sc5">FILE_ATTRIBUTE_SYSTEM</span><span class="sc0">
</span><span class="sc5">FILE_ATTRIBUTE_ARCHIVE</span><span class="sc0">
</span><span class="sc5">FILE_ATTRIBUTE_NORMAL</span><span class="sc0">
</span><span class="sc5">FILE_ATTRIBUTE_COMPRESSED</span><span class="sc0">

</span><span class="sc5">FILE_FLAG_WRITE_THROUGH</span><span class="sc0">
</span><span class="sc5">FILE_FLAG_OVERLAPPED</span><span class="sc0">
</span><span class="sc5">FILE_FLAG_NO_BUFFERING</span><span class="sc0">
</span><span class="sc5">FILE_FLAG_RANDOM_ACCESS</span><span class="sc0">
</span><span class="sc5">FILE_FLAG_SEQUENTIAL_SCAN</span><span class="sc0">
</span><span class="sc5">FILE_FLAG_DELETE_ON_CLOSE</span><span class="sc0">
</span><span class="sc5">FILE_FLAG_BACKUP_SEMANTICS</span><span class="sc0">
</span><span class="sc5">FILE_FLAG_POSIX_SEMANTICS</span><span class="sc0">

</span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0">

</span><span class="sc5">HANDLE</span><span class="sc0"> </span><span class="sc5">CreateFileMappingA</span><span class="sc0">
  </span><span class="sc4">(</span><span class="sc5">hnd</span><span class="sc4">)</span><span class="sc0">  </span><span class="sc5">hFile</span><span class="sc0">                          </span><span class="sc1">; file handle to map</span><span class="sc0">
  </span><span class="sc4">(</span><span class="sc9">ptr</span><span class="sc4">)</span><span class="sc0">  </span><span class="sc5">lpFileMappingAttributes</span><span class="sc0">        </span><span class="sc1">; ptr to SECURITY_ATTRIBUTES struc</span><span class="sc0">
         </span><span class="sc5">flProtect</span><span class="sc0">                      </span><span class="sc1">; protection for mapping object</span><span class="sc0">
         </span><span class="sc5">dwMaximumSizeHigh</span><span class="sc0">              </span><span class="sc1">; high-order 32 bitz of object size</span><span class="sc0">
         </span><span class="sc5">dwMaximumSizeLow</span><span class="sc0">               </span><span class="sc1">; low-order 32 bitz of object size</span><span class="sc0">
  </span><span class="sc4">(</span><span class="sc9">ptr</span><span class="sc4">)</span><span class="sc0">  </span><span class="sc5">lpName</span><span class="sc0">                         </span><span class="sc1">; name of file-mapping object</span><span class="sc0">
  
</span><span class="sc5">Returns</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">handle</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">file</span><span class="sc4">-</span><span class="sc5">mapping</span><span class="sc0"> </span><span class="sc5">object</span><span class="sc0"> </span><span class="sc9">if</span><span class="sc0"> </span><span class="sc5">ok</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0"> </span><span class="sc9">if</span><span class="sc0"> </span><span class="sc5">error.</span><span class="sc0">

</span><span class="sc1">; flProtect valuez:</span><span class="sc0">

</span><span class="sc5">PAGE_READONLY</span><span class="sc0">
</span><span class="sc5">PAGE_READWRITE</span><span class="sc0">
</span><span class="sc5">PAGE_WRITECOPY</span><span class="sc0">

</span><span class="sc5">SEC_COMMIT</span><span class="sc0"> 
</span><span class="sc5">SEC_IMAGE</span><span class="sc0">  
</span><span class="sc5">SEC_NOCACHE</span><span class="sc0">
</span><span class="sc5">SEC_RESERVE</span><span class="sc0">

</span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0">

</span><span class="sc5">LPVOID</span><span class="sc0"> </span><span class="sc5">MapViewOfFile</span><span class="sc0">
  </span><span class="sc4">(</span><span class="sc5">hnd</span><span class="sc4">)</span><span class="sc0">  </span><span class="sc5">hFileMappingObject</span><span class="sc0">     </span><span class="sc1">; mapping object to map into address space</span><span class="sc0">
         </span><span class="sc5">dwDesiredAccess</span><span class="sc0">        </span><span class="sc1">; access mode</span><span class="sc0">
         </span><span class="sc5">dwFileOffsetHigh</span><span class="sc0">       </span><span class="sc1">; high-order 32 bitz of file offset</span><span class="sc0">
         </span><span class="sc5">dwFileOffsetLow</span><span class="sc0">        </span><span class="sc1">; low-order 32 bitz of file offset</span><span class="sc0">
         </span><span class="sc5">dwNumberOfBytesToMap</span><span class="sc0">   </span><span class="sc1">; number of bytez to map</span><span class="sc0">
         
</span><span class="sc5">Returns</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">starting</span><span class="sc0"> </span><span class="sc5">address</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">mapped</span><span class="sc0"> </span><span class="sc5">view</span><span class="sc0"> </span><span class="sc9">if</span><span class="sc0"> </span><span class="sc5">ok</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0"> </span><span class="sc9">if</span><span class="sc0"> </span><span class="sc5">error.</span><span class="sc0">

</span><span class="sc1">; dwDesiredAccess:</span><span class="sc0">

</span><span class="sc5">FILE_MAP_WRITE</span><span class="sc0">
</span><span class="sc5">FILE_MAP_READ</span><span class="sc0">
</span><span class="sc5">FILE_MAP_ALL_ACCESS</span><span class="sc0">
</span><span class="sc5">FILE_MAP_COPY</span><span class="sc0">

</span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0">

</span><span class="sc5">HANDLE</span><span class="sc0"> </span><span class="sc5">FindFirstFileA</span><span class="sc0">
  </span><span class="sc4">(</span><span class="sc9">ptr</span><span class="sc4">)</span><span class="sc0">  </span><span class="sc5">lpFileName</span><span class="sc0">             </span><span class="sc1">; ptr to name of file to search for</span><span class="sc0">
  </span><span class="sc4">(</span><span class="sc9">ptr</span><span class="sc4">)</span><span class="sc0">  </span><span class="sc5">lpFindFileData</span><span class="sc0">         </span><span class="sc1">; ptr to WIN32_FIND_DATA struc</span><span class="sc0">

</span><span class="sc5">Returns</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">opened</span><span class="sc0"> </span><span class="sc5">handle</span><span class="sc0"> </span><span class="sc9">if</span><span class="sc0"> </span><span class="sc5">ok</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">INVALID_HANDLE_VALUE</span><span class="sc0"> </span><span class="sc9">if</span><span class="sc0"> </span><span class="sc5">error.</span><span class="sc0">
         </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">also</span><span class="sc0"> </span><span class="sc5">fills</span><span class="sc0"> </span><span class="sc5">structure</span><span class="sc0"> </span><span class="sc5">pointed</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">lpFindFileData</span><span class="sc0"> </span><span class="sc5">on</span><span class="sc0"> </span><span class="sc5">return.</span><span class="sc0">

</span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0">
</span><span class="sc4">*</span><span class="sc0">

</span><span class="sc1">; ДДґ Some macroz for most common functionz ГДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД</span><span class="sc0">

</span><span class="sc5">@OpenFile</span><span class="sc0">       </span><span class="sc9">macro</span><span class="sc0">   </span><span class="sc1">; open file with r/o or r/w access, not shared</span><span class="sc0">
                        </span><span class="sc1">; on input: ECX = desired access, EDX = pszFileName</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">                             </span><span class="sc1">; 0</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">FILE_ATTRIBUTE_NORMAL</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">OPEN_EXISTING</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">                             </span><span class="sc1">; NULL</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">                             </span><span class="sc1">; 0</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">             </span><span class="sc1">; desired access</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc0">             </span><span class="sc1">; pszFileName</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">CreateFileA</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@OpenFileR</span><span class="sc0">      </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">pszFileName</span><span class="sc0"> </span><span class="sc1">; Open file for r/o access, not shared</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">                             </span><span class="sc1">; 0</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">FILE_ATTRIBUTE_NORMAL</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">OPEN_EXISTING</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">                             </span><span class="sc1">; NULL</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">                             </span><span class="sc1">; 0</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">GENERIC_READ</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">pszFileName</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">CreateFileA</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@OpenFileW</span><span class="sc0">      </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">pszFileName</span><span class="sc0"> </span><span class="sc1">; Open file for r/w access, not shared</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">                             </span><span class="sc1">; 0</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">FILE_ATTRIBUTE_NORMAL</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">OPEN_EXISTING</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">                             </span><span class="sc1">; NULL</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">                             </span><span class="sc1">; 0</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">GENERIC_READ</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">GENERIC_WRITE</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">pszFileName</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">CreateFileA</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">
</span></div></body>
</html>
