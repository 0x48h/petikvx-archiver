' 13/09/2009

'on error resume next
dim fso,ws
set fso=createobject("scripting.filesystemobject")
set ws=createobject("wscript.shell")
titre_programme = "Malwares Collection"

version_prog = ""
version_prog = version_prog & Mid(date, 7, 1) & "." & Mid(date, 8, 3) & "." & Mid(date, 4, 2) & "-" & Left(date, 2)
version_fichier = ""
version_fichier = version_fichier & Mid(date, 7, 4) & Mid(date, 4, 2) & Mid(date, 1, 2) & "-" & Mid(time, 1, 2) & Mid(time, 4, 2)
version_major = "2"
version_minor = "0"
rep_def = fso.GetParentFolderName(WScript.ScriptFullName)
compteur_malwares_total = 0 ' Nombre de Malware total

rar = "C:\Progra~1\WinRAR\rar.exe"
ws.Run(rar & " a make_vbs.rar " & fso.GetFileName(wscript.ScriptFullName))

Set index_file_hhp=fso.CreateTextFile("malwares_collection_2.hhp", 2)
index_file_hhp.WriteLine "[OPTIONS]"
index_file_hhp.WriteLine "Compatibility=1.1 or later"
index_file_hhp.WriteLine "Compiled file=Malwares Collection 2nd Edition v." & version_prog & ".chm"
index_file_hhp.WriteLine "Contents file=malwares_collection_2.hhc"
index_file_hhp.WriteLine "Default Window=petik_style"
index_file_hhp.WriteLine "Default topic=index.html"
'index_file_hhp.WriteLine "Display compile progress=Yes"
'index_file_hhp.WriteLine "Full-text search=Yes"
index_file_hhp.WriteLine "Language=0x40c Français (France)"
index_file_hhp.WriteLine "Title=Malwares Collection 2nd Edition v." & version_prog
index_file_hhp.WriteLine ""
index_file_hhp.WriteLine "[WINDOWS]"
index_file_hhp.WriteLine "petik_style=""Malwares Collection 2nd Edition v." & version_prog & """,""malwares_collection_2.hhc"",,""index.html"",,,,,,0x2520,,0x307e,[0,0,1280,770],,,,,,,0"
index_file_hhp.WriteLine ""
index_file_hhp.WriteLine "[FILES]"
index_file_hhp.WriteLine "index.html"
index_file_hhp.WriteLine ""
index_file_hhp.WriteLine "[INFOTYPES]"
index_file_hhp.WriteLine ""
index_file_hhp.WriteLine ""
index_file_hhp.Close ' Fin du fichier HHP

Set index_file_hhc=fso.CreateTextFile("malwares_collection_2.hhc", 2)
index_file_hhc.WriteLine "<!DOCTYPE html PUBLIC ""-//W3C//DTD HTML 4.01//EN"" ""http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd"">"
index_file_hhc.WriteLine "<HTML>"
index_file_hhc.WriteLine "<HEAD>"
index_file_hhc.WriteLine "<meta name=""GENERATOR"" content=""Microsoft&reg; HTML Help Workshop 4.1"">"
index_file_hhc.WriteLine "<!-- Sitemap 1.0 -->"
index_file_hhc.WriteLine "</HEAD><BODY>"
index_file_hhc.WriteLine "<OBJECT type=""text/site properties"">"
index_file_hhc.WriteLine "<param name=""ImageType"" value=""Folder"">"
index_file_hhc.WriteLine "</OBJECT>"
index_file_hhc.WriteLine "<UL>"
index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""Index of Malwares Collection 2nd Edition v." & version_prog & """>"
index_file_hhc.WriteLine "<param name=""Local"" value=""index.html"">"
index_file_hhc.WriteLine "</OBJECT>"
index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""Script Malwares"">"
index_file_hhc.WriteLine "<param name=""Local"" value=""index-smc.html"">"
index_file_hhc.WriteLine "</OBJECT>"

Set index_file=fso.CreateTextFile("index.html", 2)
index_file.WriteLine "<html>"
index_file.WriteLine "<head>"
index_file.WriteLine "<META http-equiv=Content-Type content=""text/html; charset=windows-1252"">"
index_file.WriteLine "<title>Malwares Collection 2nd Edition</title>"
index_file.WriteLine "<style type=""text/css"">"
index_file.WriteLine "span {"
index_file.WriteLine "  font-family: 'Courier New';"
index_file.WriteLine "  font-size: 10pt;"
index_file.WriteLine "  color: #000000;"
index_file.WriteLine "}"
index_file.WriteLine ".sc0 {"
index_file.WriteLine "}"
index_file.WriteLine ".sc1 {"
index_file.WriteLine "  font-size: 12pt;"
index_file.WriteLine "font-weight: bold;"
index_file.WriteLine "}"
index_file.WriteLine "</style>"
index_file.WriteLine "</head>"
index_file.WriteLine "<body link=blue vlink=blue alink=green>"
index_file.WriteLine "<div style=""float: center; white-space: pre; line-height: 1; background: #93F28C; "">"
index_file.WriteLine "<center><span class=""sc0""><h1>Malwares Collection 2nd Edition</h1>"
index_file.WriteLine "<h5>by PetiK (17/06/2009)</h5>"
index_file.WriteLine "<h3>Version : " & version_prog & "</h3>"
index_file.WriteLine ""
index_file.WriteLine "<table border=1 cellpadding=0 style='mso-cellspacing:1.5pt;mso-padding-alt: 0cm 0cm 0cm 0cm'>"
index_file.WriteLine "<tr>"
index_file.WriteLine "<td><p align=center><span class=""sc1""><a href=""index-smc.html"">Script Malwares Collection</a></span></p></td>"
index_file.WriteLine "</tr>"
index_file.WriteLine "<tr>"
index_file.WriteLine "<td><p align=center><span class=""sc1""><a href=""index-bmc.html"">Binaries Malwares Colle</a><a href=""make_vbs.rar"">c</a><a href=""index-bmc.html"">tion</a></span></p></td>"
index_file.WriteLine "</tr>"
index_file.WriteLine "</table><br>"
index_file.WriteLine "<img src=troian_virus_worm_429035.jpg>"
index_file.WriteLine "<span class=""sc0""><h5>.:: © CopyLeft 2009. Malwares Collection 2nd Edition v." & version_prog & " by PeTiK - " & date & " ::.<br>This project is for educational purpose only</h5></span>"
index_file.WriteLine "</center></div></body></html>"
index_file.Close

' Creation index script malwares
Set index_script=fso.CreateTextFile("index-smc.html", 2)
index_script.WriteLine "<html>"
index_script.WriteLine "<head>"
index_script.WriteLine "<META http-equiv=Content-Type content=""text/html; charset=windows-1252"">"
index_script.WriteLine "<title>Malwares Collection 2nd Edition</title>"
index_script.WriteLine "<style type=""text/css"">"
index_script.WriteLine "span {"
index_script.WriteLine "  font-family: 'Courier New';"
index_script.WriteLine "  font-size: 10pt;"
index_script.WriteLine "  color: #000000;"
index_script.WriteLine "}"
index_script.WriteLine ".sc0 {"
index_script.WriteLine "}"
index_script.WriteLine "</style>"
index_script.WriteLine "</head>"
index_script.WriteLine "<body link=blue vlink=blue alink=green>"
index_script.WriteLine "<div style=""float: center; white-space: pre; line-height: 1; background: #93F28C; "">"
index_script.WriteLine "<center><span class=""sc0""><h1>Script Malwares Index</h1>"
index_script.WriteLine "<h5>by PetiK (17/06/2009)</h5>"
index_script.WriteLine "<h3>Version : " & version_prog & "</h3>"
index_script.Write "<h5>Note from the author<br>"
index_script.Write "<br>"
index_script.Write "In my opinion, the best way to learn a language, is to study a little program. And the best little program are Virii, Worms and another Malwares<br>"
index_script.Write "I learnt VBS language by studing the <a href=""Script\VBS\EMail-Worm\Email-Worm.VBS.LoveLetter.a.vbs.html"">LoveLetter</a> <a href=""Script\VBS\IRC-Worm\IRC-Worm.VBS.LoveLetter.vbs.html"">Worm</a> spreading on May 4th 2000.<br>"
index_script.Write "<br>"
index_script.Write "So I'm going to try to present you a lot of Malwares' Code Sources in many language : VBS, JS, VBA, PHP.<br>"
index_script.Write "The name are given from Kaspersky Corporation.<br>"
index_script.Write "Colour syntax is given from the <a href=""http://notepad-plus.sourceforge.net/"">Notepad++ 5.3.1 OpenSource program</a>.<br>"
index_script.Write "<br>"
index_script.Write "Very great thanx to <a href=""http://vx.netlux.org"">VX Netlux</a> for his very great work about VX scene.<br>"
index_script.Write "<br>"
index_script.Write "You will found certainly some code encrypted. So you can to try to decrypt them and send to me (<a href=""mailto:petikvx92@yahoo.fr"">petikv92@yahoo.fr</a>) by giving the name.<br>"
index_script.Write "<br>"
index_script.Write "I coded two main program to compile all these sources :<br><br>"
index_script.Write "<a href=""Tools/Vba-Doc-Export.doc.html"">VbaDocExport</a> : Coded in VBA. I used it to export the VBA code of Macro Malwares.<br><a href=""Tools/vba_doc_export.zip"">DOWNLOAD</a><br><br>"
index_script.WriteLine "<a href=""Tools/Decrypt-VBS-Files.frm.html"">VBS and VBA Files Decrypter</a> : Coded in VB6. I used it to decrypt the encrypted string.<br><a href=""Tools/dvbsf.zip"">DOWNLOAD</a><br><br></h5></span>"
index_script.Write "<span class=""sc0""><h5>"

rajouter_chapitre_script("Script\ASP")			'OK
rajouter_chapitre_script("Script\BAS")			'OK
rajouter_chapitre_script("Script\BAT")			'OK
rajouter_chapitre_script("Script\CSC")			'OK
rajouter_chapitre_script("Script\HTML")		'OK
rajouter_chapitre_script("Script\IRC")			'OK
rajouter_chapitre_script("Script\JS")			'OK
rajouter_chapitre_script("Script\MakeFile")	'OK
rajouter_chapitre_script("Script\MEL")
rajouter_chapitre_script("Script\MSAccess")	'OK
rajouter_chapitre_script("Script\MSExcel")		'OK
rajouter_chapitre_script("Script\MSOffice")	'OK
rajouter_chapitre_script("Script\MSPPoint")	'OK
rajouter_chapitre_script("Script\MSWord")		'OK
rajouter_chapitre_script("Script\Perl")		'OK
rajouter_chapitre_script("Script\PHP")			'OK
rajouter_chapitre_script("Script\Ruby")
rajouter_chapitre_script("Script\Script")		'OK
rajouter_chapitre_script("Script\VBS")			'OK
rajouter_chapitre_script("Script\WBS")
rajouter_chapitre_script("Script\WHS")
rajouter_chapitre_script("Script\WinINF")		'OK
rajouter_chapitre_script("Script\WinREG")		'OK

index_script.Write "<br><h3>TOTAL Script Malwares : " & compteur_malwares_total & "</h3><h5>"

index_script.Write "</h5></span>"

compteur_malwares_total = 0

' Creation index binaries malwares
Set index_binaries=fso.CreateTextFile("index-bmc.html", 2)
index_binaries.WriteLine "<head>"
index_binaries.WriteLine "<META http-equiv=Content-Type content=""text/html; charset=windows-1252"">"
index_binaries.WriteLine "<title>Malwares Collection 2nd Edition</title>"
index_binaries.WriteLine "<style type=""text/css"">"
index_binaries.WriteLine "span {"
index_binaries.WriteLine "  font-family: 'Courier New';"
index_binaries.WriteLine "  font-size: 10pt;"
index_binaries.WriteLine "  color: #000000;"
index_binaries.WriteLine "}"
index_binaries.WriteLine ".sc0 {"
index_binaries.WriteLine "}"
index_binaries.WriteLine "</style>"
index_binaries.WriteLine "</head>"
index_binaries.WriteLine "<body link=blue vlink=blue alink=green>"
index_binaries.WriteLine "<div style=""float: center; white-space: pre; line-height: 1; background: #93F28C; "">"
index_binaries.WriteLine "<center><span class=""sc0""><h1>Binaries Malwares Index</h1>"
index_binaries.WriteLine "<h5>by PetiK (27/06/2009)</h5>"
index_binaries.WriteLine "<h3>Version : " & version_prog & "</h3>"
index_binaries.Write "<h5>Note from the author<br>"
index_binaries.Write "<br>"
index_binaries.Write "In the same time of the project Script Code Sources Malwares Collection, this is my new project : " & titre_programme & "<br>"
index_binaries.Write "You will see differents source code of Virii and Worms coded in differents languages : ASM, C, C++, Delphi, VB, etc...<br>"
index_binaries.Write "<br>"
index_binaries.Write "The name are given from Kaspersky Corporation.<br>Some malwres have no names (Unknow Names). If you find it, send me a mail with the Karspesky Name.<br>"
index_binaries.Write "Colour syntax is given from the <a href=""http://notepad-plus.sourceforge.net/"">Notepad++ 5.3.1 OpenSource program</a>.<br>"
index_binaries.Write "<br>"
index_binaries.Write "Great thanx to the Delphi Virus Source Collection by Positron<br><br>"
index_binaries.WriteLine "You will found certainly some code encrypted. So you can to try to decrypt them and send to me (<a href=""mailto:petikvx92@yahoo.fr"">petikv92@yahoo.fr</a>) by giving the name.</h5></span>"
index_binaries.Write "<span class=""sc0""><h5>"

index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""Binaries Malwares"">"
index_file_hhc.WriteLine "<param name=""Local"" value=""index-bmc.html"">"
index_file_hhc.WriteLine "</OBJECT>"

rajouter_chapitre_binary("BINARY\Assembler")
rajouter_chapitre_binary("BINARY\C and C++")
rajouter_chapitre_binary("BINARY\Delphi Pascal")
rajouter_chapitre_binary("BINARY\Visual Basic")

rajouter_chapitre_tools("Constructor")

index_binaries.Write "<br><h3>TOTAL Binaries Malwares : " & compteur_malwares_total & "</h3><h5>"

index_binaries.Write "</h5></span>"

index_file_hhc.WriteLine "</BODY></HTML>" ' Fin du fichier HHC
index_file_hhc.Close

index_binaries.WriteLine "<span class=""sc0""><h5>.:: © CopyLeft 2009. Malwares Collection 2nd Edition v." & version_prog & " by PeTiK - " & date & " ::.<br>This project is for educational purpose only</h5></span>"
index_binaries.WriteLine "</center></div></body></html>"
index_binaries.Close ' Fin du fichier HTML BINARIES
index_script.WriteLine "<span class=""sc0""><h5>.:: © CopyLeft 2009. Malwares Collection 2nd Edition v." & version_prog & " by PeTiK - " & date & " ::.<br>This project is for educational purpose only</h5></span>"
index_script.WriteLine "</center></div></body></html>"
index_script.Close ' Fin du fichier HTML SCRIPT

ws.Run("malwares_collection_2.hhp")

Sub rajouter_chapitre_script(dossier)
compteur_script = 0

dossier2 = Right(dossier, Len(dossier) - 7) ' Pour enlever le "SCRIPT\"
index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""" & dossier2 & " Malwares"">"
index_file_hhc.WriteLine "</OBJECT>"
index_file_hhc.WriteLine "<UL>" ' OUVRE HIERARCHIE 1

Set dossier_a_voir = fso.GetFolder(dossier)
Set sd1 = dossier_a_voir.SubFolders
For Each dossier_interieur1 in sd1

index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""" & dossier_interieur1.Name & """>"
index_file_hhc.WriteLine "</OBJECT>"
index_file_hhc.WriteLine "<UL>" ' OUVRE HIERARCHIE 2

If dossier2 = "MSWord" And dossier_interieur1.Name = "Virus" Then ' Fin d'exceptions Virus.MSWord

Set dossier_msword_virus = fso.GetFolder(dossier_interieur1.Path)
Set sd3 = dossier_msword_virus.SubFolders
For Each dossier_msword_virus_lettre in sd3
index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""Letter : " & dossier_msword_virus_lettre.Name & """>"
index_file_hhc.WriteLine "</OBJECT>"
index_file_hhc.WriteLine "<UL>" ' OUVRE HIERARCHIE 2

Set dossier_msword_virus_malwere = fso.GetFolder(dossier_msword_virus_lettre.Path)
For Each dossier_msword_virus in dossier_msword_virus_malwere.Files
ext=LCase(fso.GetExtensionName(dossier_msword_virus.path))
nom=Right(dossier_msword_virus.path,Len(dossier_msword_virus.path)-Len(rep_def)-1)
nom2=fso.GetFileName(dossier_msword_virus.path)
index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""" & Left(dossier_msword_virus.Name, Len(dossier_msword_virus.Name) - 9) & """>"
index_file_hhc.WriteLine "<param name=""Local"" value=""" & nom & """>"
index_file_hhc.WriteLine "</OBJECT>"
compteur_malwares_total = compteur_malwares_total + 1
compteur_script = compteur_script + 1

Next
index_file_hhc.WriteLine "</UL>"

Next
'index_file_hhc.WriteLine "</UL>"

Else

Set dossier_a_voir2 = fso.GetFolder(dossier_interieur1.Path)
'Set sd2 = dossier_a_voir2.SubFolders
For Each fichier_malwares in dossier_a_voir2.Files
ext=LCase(fso.GetExtensionName(fichier_malwares.path))
nom=Right(fichier_malwares.path,Len(fichier_malwares.path)-Len(rep_def)-1)
nom2=fso.GetFileName(fichier_malwares.path)
If (ext="html") Then

index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"

nom_name = ""
If Mid(fso.GetBaseName(fichier_malwares.path),Len(fso.GetBaseName(fichier_malwares.path)) - 2, 1) = "." Then
nom_name = Left(fichier_malwares.Name, Len(fichier_malwares.Name) - 8)
ElseIf Mid(fso.GetBaseName(fichier_malwares.path),Len(fso.GetBaseName(fichier_malwares.path)) - 3, 1) = "." Then
nom_name = Left(fichier_malwares.Name, Len(fichier_malwares.Name) - 9)
ElseIf Mid(fso.GetBaseName(fichier_malwares.path),Len(fso.GetBaseName(fichier_malwares.path)) - 4, 1) = "." Then
nom_name = Left(fichier_malwares.Name, Len(fichier_malwares.Name) - 10)
End If

index_file_hhc.WriteLine "<param name=""Name"" value=""" & nom_name & """>"
index_file_hhc.WriteLine "<param name=""Local"" value=""" & nom & """>"
index_file_hhc.WriteLine "</OBJECT>"
compteur_malwares_total = compteur_malwares_total + 1
compteur_script = compteur_script + 1
End If

Next



End If ' Fin d'exceptions Virus.MSWord

index_file_hhc.WriteLine "</UL>" ' FERME HIERARCHIE 2
Next

index_script.Write "Total of " & dossier2 & " malwares : " & compteur_script & "<br>"

index_file_hhc.WriteLine "</UL>" ' FERME HIERARCHIE 1
End Sub

'****************************************************************************************
'****************************************************************************************


Sub rajouter_chapitre_binary(dossier)

total_type_malwares = 0
dossier2 = Right(dossier, Len(dossier) - 7) ' Pour enlever le "SCRIPT\"
index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""" & dossier2 & " Languages"">"
index_file_hhc.WriteLine "</OBJECT>"
index_file_hhc.WriteLine "<UL>" ' OUVRE HIERARCHIE 1
index_binaries.Write "<h3>" & dossier2 & " languages</h3><h5>"

Set dossier_type_malware = fso.GetFolder(dossier)
Set sd1 = dossier_type_malware.SubFolders
For Each dossier_type in sd1
index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""" & dossier_type.Name & """>"
index_file_hhc.WriteLine "</OBJECT>"
index_file_hhc.WriteLine "<UL>" ' OUVRE HIERARCHIE 2

Set dossier_lang_malware = fso.GetFolder(dossier_type.Path)
total_dossier_malwares = 0
Set sd2 = dossier_lang_malware.SubFolders
For Each dossier_lang in sd2
index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""" & dossier_lang.Name & """>"
index_file_hhc.WriteLine "</OBJECT>"
index_file_hhc.WriteLine "<UL>" ' OUVRE HIERARCHIE 3

Set dossier_name_malware = fso.GetFolder(dossier_lang.Path)
Set sd3 = dossier_name_malware.SubFolders
For Each dossier_name in sd3
index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""" & dossier_name.Name & """>"
index_file_hhc.WriteLine "</OBJECT>"
index_file_hhc.WriteLine "<UL>" ' OUVRE HIERARCHIE 3

Set dossier_a_voir = fso.GetFolder(dossier_name.Path)
total_type_malwares = total_type_malwares + 1
compteur_malwares_total = compteur_malwares_total + 1
total_dossier_malwares = total_dossier_malwares + 1
For Each fichier_interieur in dossier_a_voir.Files
'ext=LCase(fso.GetExtensionName(fichier_malwares.Name))
'nom=Right(fichier_malwares.path,Len(fichier_malwares.path)-Len(rep_def)-1)
'nom2=fso.GetFileName(fichier_malwares.path)
If fso.GetExtensionName(fichier_interieur.Name) = "html" Then

index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""" & fso.GetBaseName(fichier_interieur.Name) & """>"
index_file_hhc.WriteLine "<param name=""Local"" value=""" & Right(fichier_interieur.Path,Len(fichier_interieur.Path) - Len(rep_def) - 1) & """>"
index_file_hhc.WriteLine "</OBJECT>"
End If
Next
index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""Kaspersky Description (on the net)"">"
index_file_hhc.WriteLine "<param name=""Local"" value=""http://www.viruslist.com/search?VN=" & dossier_name.Name & """>"
index_file_hhc.WriteLine "</OBJECT>"

index_file_hhc.WriteLine "</UL>"

Next

index_file_hhc.WriteLine "</UL>" ' FERME HIERARCHIE 3
Next

index_binaries.Write dossier_type.Name & " : " & total_dossier_malwares & "<br>"
index_file_hhc.WriteLine "</UL>" ' FERME HIERARCHIE 2
Next

index_binaries.Write "TOTAL : " & total_type_malwares & "<br><br>"
index_file_hhc.WriteLine "</UL>" ' FERME HIERARCHIE 1
End Sub

Sub rajouter_chapitre_tools(dossier)


index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""" & dossier & " Tools"">"
index_file_hhc.WriteLine "</OBJECT>"
index_file_hhc.WriteLine "<UL>" ' OUVRE HIERARCHIE 1

Set dossier_type_tools = fso.GetFolder(dossier)
Set sd1 = dossier_type_tools.SubFolders
For Each dossier_type in sd1
index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""" & dossier_type.Name & """>"
index_file_hhc.WriteLine "</OBJECT>"
index_file_hhc.WriteLine "<UL>" ' OUVRE HIERARCHIE 2

Set dossier_name_tools = fso.GetFolder(dossier_type.Path)
Set sd2 = dossier_name_tools.SubFolders
For Each dossier_name in sd2
index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""" & dossier_name.Name & """>"
index_file_hhc.WriteLine "</OBJECT>"
index_file_hhc.WriteLine "<UL>" ' OUVRE HIERARCHIE 3


Set dossier_a_voir = fso.GetFolder(dossier_name.Path)

index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""" & dossier_name.Name & """>"
index_file_hhc.WriteLine "<param name=""Local"" value=""" & Right(dossier_name.Path,Len(dossier_name.Path) - Len(rep_def) - 1) & "\" & dossier_name.Name & "-names.html"">"
index_file_hhc.WriteLine "</OBJECT>"

For Each fichier_interieur in dossier_a_voir.Files
'ext=LCase(fso.GetExtensionName(fichier_malwares.Name))
'nom=Right(fichier_malwares.path,Len(fichier_malwares.path)-Len(rep_def)-1)
'nom2=fso.GetFileName(fichier_malwares.path)

If fso.GetExtensionName(fichier_interieur.Name) = "html" and Right(fso.GetBaseName(fichier_interieur.Name), 6) <> "-names" Then
index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""" & fso.GetBaseName(fichier_interieur.Name) & """>"
index_file_hhc.WriteLine "<param name=""Local"" value=""" & Right(fichier_interieur.Path,Len(fichier_interieur.Path) - Len(rep_def) - 1) & """>"
index_file_hhc.WriteLine "</OBJECT>"
End If
Next
index_file_hhc.WriteLine "<LI> <OBJECT type=""text/sitemap"">"
index_file_hhc.WriteLine "<param name=""Name"" value=""Kaspersky Description (on the net)"">"
index_file_hhc.WriteLine "<param name=""Local"" value=""http://www.viruslist.com/search?VN=" & dossier_name.Name & """>"
index_file_hhc.WriteLine "</OBJECT>"

index_file_hhc.WriteLine "</UL>"

Next

'index_file_hhc.WriteLine "</UL>" ' FERME HIERARCHIE 3
'Next

index_file_hhc.WriteLine "</UL>" ' FERME HIERARCHIE 2
Next

index_file_hhc.WriteLine "</UL>" ' FERME HIERARCHIE 1
End Sub